<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.83.1" />

  <title>Maven : créer une branche - Mode d&#39;emploi &middot; Jetoile</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://blog.jetoile.fr/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://blog.jetoile.fr/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://blog.jetoile.fr/css/my.css">
    
  
  
    
        <script src="https://blog.jetoile.fr/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://blog.jetoile.fr/">Jetoile</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/post"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/hadoop-unit"><i class='fa fa-list fa-fw'></i>Hadoop Unit</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/jetoile" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/jetoile" rel="me" target="_blank"><i class="fab fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/khanh-tuong-maudoux-11b92b19" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/jetoile" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small><a href='http://creativecommons.org/licenses/by/4.0/' rel='license'><img alt='Licence Creative Commons' src='https://blog.jetoile.fr/images/creative_common88x31.png' style='border-width:0'/></a></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Maven : créer une branche - Mode d&#39;emploi</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Aug 2012</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/java">java</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/maven">maven</a>
    
  </div>
  
  

</div>

  <p><img src="http://1.bp.blogspot.com/-l-NZQRxE0vI/TevA5LfJQ_I/AAAAAAAAAXI/IP8zRk4wbeg/s1600/maven-logo-2.gif" alt="left-small"></p>
<p>Il y a un moment déjà, j&rsquo;avais fait un <a href="https://blog.jetoile.fr/2010/04/le-plugin-release-un-peu-demystifie.html">article sur le plugin release</a> oh combien pratique dans notre utilisation de maven. J&rsquo;y avais mentionné les 2 goals <code>prepare</code> et <code>perform</code> qui sont les plus connus et qui, pour rappel, permettent de :</p>
<ul>
<li>vérifier que lors du lancement du processus de génération du livrable, le code est bien conforme à ce qui se trouve sur le SCM,</li>
<li>tagger le code source à partir duquel le livrable est produit et permettant ainsi sa reproductivité,</li>
<li>incrémenter le numéro de version des poms,</li>
<li>générer le livrable,</li>
<li>et le déployer sur le <em>remote proxy repository</em>.</li>
</ul>
<p>Dans cet article, je me concentrerai sur un goal du plugin release malheureusement assez méconnu mais qui est tout aussi pratique et important (à mon sens) que ses 2 comparses <code>prepare</code> et <code>perform</code>. Il s&rsquo;agit du plugin <strong>branch</strong>.</p>
<!-- more -->
<p>Ce plugin permet de créer une branche en utilisant un sous-ensemble de ce que fait le goal prepare mais appliqué à une branche plutôt qu&rsquo;à un tag :</p>
<ul>
<li>vérifie que lors du lancement du processus de création de branche, le code est bien conforme à ce qui se trouve sur le SCM (ie. qu&rsquo;il n&rsquo;y a pas de modification en local),</li>
<li>modifie optionnellement la version du pom qui sera utilisé sur la branche créée (ie. cible),</li>
<li>transforme les informations du SCM dans le pom (ie. le contenu des éléments fils de l&rsquo;élément scm afin qu&rsquo;ils correspondent à la branche),</li>
<li>commite le pom modifié,</li>
<li>tag le code dans le SCM comme une nouvelle branche,</li>
<li>modifie optionnellement la version du pom si une nouvelle version doit être utilisée sur la branche/trunk/master source (enfin sur la code ayant servi à créer la branche),</li>
<li>commite le pom modifié.</li>
</ul>
<p>Pour les habitués de ce blog (ndlr : oui&hellip; j&rsquo;avoue&hellip; un peu mort en ce moment&hellip; ), ils sauront que j&rsquo;ai tendance à m&rsquo;appuyer fortement sur la documentation officielle, chose que je ne changerai pas dans cet article.</p>
<p>Il est à noter que cet article n&rsquo;est, en fait, qu&rsquo;un prétexte afin de me servir d&rsquo;aide mémoire sur la ligne de commande à utiliser pour effectuer cette opération&hellip; mais vu que je suis hyper sympa (&hellip; ou pas&hellip;), je développerai un peu plus que la simple commande à taper&hellip; ;-)</p>
<p>Enfin, je ne reviendrai pas sur le fait que créer une branche doit, bien évidemment, se faire dans les règles de l&rsquo;art (ie. au moins pouvoir permettre une itération du numéro de version du pom dans le cas de branches correctives et le changement de la valeur des balises contenu dans l&rsquo;élément scm).</p>
<p>#Les options</p>
<p>Les options les plus utiles (à mon sens) disponibles sont les suivantes :</p>
<ul>
<li><code>branchName</code> : permet de définir le nom de la branche à créer.</li>
<li><code>autoVersionSubmodules</code> : permet d&rsquo;utiliser automatiquement la même version que celle du parent. Si elle est mise à false (valeur par défaut), alors une version sera demandé pour chaque sous module.</li>
<li><code>branchBase</code> : permet de redéfinir le répertoire de base des branches dans SVN si les préconisations SVN n&rsquo;ont pas été respectées.</li>
<li><code>developmentVersion</code> : permet de préciser la version à mettre pour la nouvelle copie local de travail.</li>
<li><code>dryRyun</code> : permet de faire un checkout local plutôt que de le faire sur le repository. Ainsi, par exemple, cette option peut être utile pour savoir si les modifications qui seront apportées aux pom qui seront poussés sur le SCM sont bien celles attendues.</li>
<li><code>localCheckout</code> : permet de faire un checkout local plutôt qu&rsquo;un distant (utile seulement pour les SCM de type DVCS qui supportent le protocole file - git, jgit, hg - ).</li>
<li><code>pushChanges</code> : permet, seulement avec git, de pousser ou non ses changements sur le repository distant (par défaut, true).</li>
<li><code>updateBranchVersions</code> : permet de définir la version à mettre sur la branche (par défaut, false).</li>
<li><code>updateDependencies</code> : permet de mettre à jour la version du pom pour la prochaine phase de développement (par défaut, true).</li>
<li><code>updateWorkingCopyVersion</code> : permet de mettre à jour la version sur la copie de travail locale (par défault, true).</li>
</ul>
<p>Enfin, il est possible de préciser la version à utiliser dans le ligne de commande. Cela peut être utile, par exemple, si la commande est exécutée en commande non interactive. Le goal branch peut utiliser les mêmes propriétés utilisées par le goal prepare pour définir les versions à utiliser.</p>
<p>Exemple :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mvn --batch-mode release:branch -DbranchName<span style="color:#f92672">=</span>my-branch-1.2 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-Dproject.rel.org.myCompany:projectA<span style="color:#f92672">=</span>1.2 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-Dproject.dev.org.myCompany:projectA<span style="color:#f92672">=</span>2.0-SNAPSHOT 
</code></pre></div><p>Dans cet exemple, le pom dans la nouvelle branche sera en version 1.2-SNAPSHOT alors que le pom local sera en version 2.0-SNAPSHOT.</p>
<p>#La commande! La commande!&hellip; enfin</p>
<p>Bon, voilà la commande tant attendue que j&rsquo;utilise le plus souvent :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mvn --batch-mode release:branch <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-DbranchName<span style="color:#f92672">=</span>&lt;nomBrancheACreer&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-DupdateBranchVersions<span style="color:#f92672">=</span>true <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-DupdateWorkingCopyVersions<span style="color:#f92672">=</span>false <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-DautoVersionSubmodules<span style="color:#f92672">=</span>true <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-Dproject.rel.&lt;groupId&gt;:&lt;artifactId&gt;<span style="color:#f92672">=</span>&lt;version&gt; 
</code></pre></div><p>avec la déclaration suivante :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;plugin&gt;</span>
 <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#f92672">&lt;/groupId&gt;</span>
 <span style="color:#f92672">&lt;artifactId&gt;</span>maven-release-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
 <span style="color:#f92672">&lt;version&gt;</span>2.3.2<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/plugin&gt;</span>
</code></pre></div><h1 id="conclusion">Conclusion</h1>
<p>En conclusion de ce court article, pas grand chose à ajouter sauf que le goal <code>branch</code> du plugin <strong>release</strong> est vraiment très utile puisqu&rsquo;il permet en une seule commande de faire plusieurs opérations qui se trouvent être assez rébarbatives.</p>
<h1 id="pour-aller-plus-loin">Pour aller plus loin&hellip;</h1>
<p><a href="http://maven.apache.org/plugins/maven-release-plugin/branch-mojo.html%60">http://maven.apache.org/plugins/maven-release-plugin/branch-mojo.html`</a></p>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f08%2fmaven-creer-une-branche-mode-demloi.html" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://blog.jetoile.fr/2012/05/devoxx-2012-elasticsearch-moteur-de.html"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://blog.jetoile.fr/2012/05/devoxx-2012-elasticsearch-moteur-de.html">Devoxx 2012 - ElasticSearch : moteur de recherche NoSQL/REST/JSON taillé pour le cloud</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://blog.jetoile.fr/2012/08/decoupage-de-projets-projet-vs-modules.html">Découpage de projets : projet vs. modules</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://blog.jetoile.fr/2012/08/decoupage-de-projets-projet-vs-modules.html"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'jetoile';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  

</div>

</div>
</div>
<script src="https://blog.jetoile.fr/js/ui.js"></script>
<script src="https://blog.jetoile.fr/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-11955429-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="https://blog.jetoile.fr/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

