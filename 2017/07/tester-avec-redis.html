<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.83.1" />

  <title>Des tests d&#39;intégration avec Redis &middot; Jetoile</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://blog.jetoile.fr/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://blog.jetoile.fr/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://blog.jetoile.fr/css/my.css">
    
  
  
    
        <script src="https://blog.jetoile.fr/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://blog.jetoile.fr/">Jetoile</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/post.html"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/about.html"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/contact.html"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/hadoop-unit"><i class='fa fa-list fa-fw'></i>Hadoop Unit</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/jetoile" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/jetoile" rel="me" target="_blank"><i class="fab fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/khanh-tuong-maudoux-11b92b19" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/jetoile" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small><a href='http://creativecommons.org/licenses/by/4.0/' rel='license'><img alt='Licence Creative Commons' src='https://blog.jetoile.fr/images/creative_common88x31.png' style='border-width:0'/></a></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Des tests d&#39;intégration avec Redis</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>17 Jul 2017</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/redis">Redis</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/test">Test</a>
    
  </div>
  
  

</div>

  <p><img src="https://blog.jetoile.fr/images/redis.png" alt="left-small"> Redis est écrit en C et faire des tests d&rsquo;intégration en Java peut s&rsquo;avérer compliquer. En outre, le fait que Redis doive être compilé lors de son installation rend les choses encore moins aisées.</p>
<p>Bien sûr, il est possible d&rsquo;utiliser Docker ou de l&rsquo;installer préalablement sur son poste mais cette deuxième option casse un peu les bonnes pratiques des tests.</p>
<p>Il existe également de nombreux projets permettant de faire des tests avec Redis mais, souvent, les solutions proposées embarquent le binaire de Redis ou on besoin qu&rsquo;il soit déjà présent et installer/compiler sur le poste (<a href="https://github.com/kstyrc/embedded-redis,">https://github.com/kstyrc/embedded-redis,</a> <a href="https://github.com/lordofthejars/nosql-unit,">https://github.com/lordofthejars/nosql-unit,</a> <a href="https://github.com/ishiis/redis-unit)">https://github.com/ishiis/redis-unit)</a>. Les solutions qui intègrent le binaire ne sont malheureusement souvent pas à jour et laisse assez peu la main sur la version.</p>
<p>Pour ceux qui n&rsquo;aurait pas envie d&rsquo;utiliser Docker, cet article va montrer comment il est possible de piloter programmatiquement l&rsquo;installation de Redis afin de permettre les tests d&rsquo;intégration.</p>
<!-- more -->
<p>En fait, le code ci-dessous se charge de télécharger Redis et de le compiler dans le répertoire <code>$USER_HOME/.redis</code>. Pour ce faire une tache ant est utilisée car un appel direct à la commande make échoue.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> org.apache.commons.io.FileUtils<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.apache.commons.io.IOUtils<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.apache.tools.ant.BuildException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.apache.tools.ant.DefaultLogger<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.apache.tools.ant.Project<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.apache.tools.ant.ProjectHelper<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.codehaus.plexus.archiver.ArchiverException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.codehaus.plexus.archiver.tar.TarGZipUnArchiver<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.codehaus.plexus.logging.console.ConsoleLogger<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.slf4j.Logger<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> org.slf4j.LoggerFactory<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> java.io.File<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.InputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.OutputStream<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.net.URL<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.nio.file.Path<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.nio.file.Paths<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.Arrays<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.util.List<span style="color:#f92672">;</span>

<span style="color:#f92672">import static</span> org.apache.commons.io.FileUtils.getFile<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisInstaller</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Logger LOGGER <span style="color:#f92672">=</span> LoggerFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getLogger</span><span style="color:#f92672">(</span>RedisInstaller<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String REDIS_PACKAGE_PREFIX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;redis-&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> REDIS_EXECUTABLE_FILE <span style="color:#f92672">=</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;redis-server&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;redis-sentinel&#34;</span><span style="color:#f92672">);</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Path REDIS_INSTALLATION_PATH <span style="color:#f92672">=</span> Paths<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">getProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;user.home&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/.redis&#34;</span><span style="color:#f92672">);</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String downloadUrl<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String version<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">boolean</span> forceCleanupInstallationDirectory<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String tmpDir<span style="color:#f92672">;</span>

    RedisInstaller<span style="color:#f92672">(</span>String version<span style="color:#f92672">,</span> String downloadUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">boolean</span> forceCleanupInstallationDirectory<span style="color:#f92672">,</span> String tmpDir<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">downloadUrl</span> <span style="color:#f92672">=</span> downloadUrl<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">version</span> <span style="color:#f92672">=</span> version<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">forceCleanupInstallationDirectory</span> <span style="color:#f92672">=</span> forceCleanupInstallationDirectory<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">tmpDir</span> <span style="color:#f92672">=</span> tmpDir<span style="color:#f92672">;</span>
        REDIS_INSTALLATION_PATH<span style="color:#f92672">.</span><span style="color:#a6e22e">toFile</span><span style="color:#f92672">().</span><span style="color:#a6e22e">mkdirs</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    File <span style="color:#a6e22e">getExecutableFile</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> fileRelativeToInstallationDir<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;src&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;redis-server&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> File <span style="color:#a6e22e">fileRelativeToInstallationDir</span><span style="color:#f92672">(</span>String<span style="color:#f92672">...</span> path<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> getFile<span style="color:#f92672">(</span>getInstallationDirectory<span style="color:#f92672">(),</span> path<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> File <span style="color:#a6e22e">getInstallationDirectory</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> getFile<span style="color:#f92672">(</span>REDIS_INSTALLATION_PATH<span style="color:#f92672">.</span><span style="color:#a6e22e">toFile</span><span style="color:#f92672">(),</span> REDIS_PACKAGE_PREFIX <span style="color:#f92672">+</span> version<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">install</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> InterruptedException <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>forceCleanupInstallationDirectory<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            FileUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">forceDelete</span><span style="color:#f92672">(</span>getInstallationDirectory<span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
        installRedis<span style="color:#f92672">();</span>
        makeRedis<span style="color:#f92672">();</span>
        applyRedisPermissionRights<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">installRedis</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        Path downloadedTo <span style="color:#f92672">=</span> download<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> URL<span style="color:#f92672">(</span>downloadUrl <span style="color:#f92672">+</span> REDIS_PACKAGE_PREFIX <span style="color:#f92672">+</span> version <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.tar.gz&#34;</span><span style="color:#f92672">));</span>
        install<span style="color:#f92672">(</span>downloadedTo<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> File <span style="color:#a6e22e">getAntFile</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        InputStream in <span style="color:#f92672">=</span> RedisInstaller<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">().</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;build.xml&#34;</span><span style="color:#f92672">);</span>
        File fileOut <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>tmpDir<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;build.xml&#34;</span><span style="color:#f92672">);</span>

        LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Writing redis&#39; build.xml to: &#34;</span> <span style="color:#f92672">+</span> fileOut<span style="color:#f92672">.</span><span style="color:#a6e22e">getAbsolutePath</span><span style="color:#f92672">());</span>

        OutputStream out <span style="color:#f92672">=</span> FileUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">openOutputStream</span><span style="color:#f92672">(</span>fileOut<span style="color:#f92672">);</span>
        IOUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">(</span>in<span style="color:#f92672">,</span> out<span style="color:#f92672">);</span>
        in<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
        out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>

        <span style="color:#66d9ef">return</span> fileOut<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">makeRedis</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> InterruptedException <span style="color:#f92672">{</span>
        LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&gt; make&#34;</span><span style="color:#f92672">);</span>
        File makeFilePath <span style="color:#f92672">=</span> getInstallationDirectory<span style="color:#f92672">();</span>

        DefaultLogger consoleLogger <span style="color:#f92672">=</span> getConsoleLogger<span style="color:#f92672">();</span>

        Project project <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Project<span style="color:#f92672">();</span>
        File buildFile <span style="color:#f92672">=</span> getAntFile<span style="color:#f92672">();</span>
        project<span style="color:#f92672">.</span><span style="color:#a6e22e">setUserProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ant.file&#34;</span><span style="color:#f92672">,</span> buildFile<span style="color:#f92672">.</span><span style="color:#a6e22e">getAbsolutePath</span><span style="color:#f92672">());</span>
        project<span style="color:#f92672">.</span><span style="color:#a6e22e">addBuildListener</span><span style="color:#f92672">(</span>consoleLogger<span style="color:#f92672">);</span>

        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">fireBuildStarted</span><span style="color:#f92672">();</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">();</span>
            ProjectHelper projectHelper <span style="color:#f92672">=</span> ProjectHelper<span style="color:#f92672">.</span><span style="color:#a6e22e">getProjectHelper</span><span style="color:#f92672">();</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">addReference</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ant.projectHelper&#34;</span><span style="color:#f92672">,</span> projectHelper<span style="color:#f92672">);</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">setProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;redisDirectory&#34;</span><span style="color:#f92672">,</span> makeFilePath<span style="color:#f92672">.</span><span style="color:#a6e22e">getAbsolutePath</span><span style="color:#f92672">());</span>
            projectHelper<span style="color:#f92672">.</span><span style="color:#a6e22e">parse</span><span style="color:#f92672">(</span>project<span style="color:#f92672">,</span> buildFile<span style="color:#f92672">);</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">executeTarget</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;init&#34;</span><span style="color:#f92672">);</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">fireBuildFinished</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>BuildException buildException<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            project<span style="color:#f92672">.</span><span style="color:#a6e22e">fireBuildFinished</span><span style="color:#f92672">(</span>buildException<span style="color:#f92672">);</span>
            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!!! Unable to compile redis !!!&#34;</span><span style="color:#f92672">,</span> buildException<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> DefaultLogger <span style="color:#a6e22e">getConsoleLogger</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        DefaultLogger consoleLogger <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DefaultLogger<span style="color:#f92672">();</span>
        consoleLogger<span style="color:#f92672">.</span><span style="color:#a6e22e">setErrorPrintStream</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">err</span><span style="color:#f92672">);</span>
        consoleLogger<span style="color:#f92672">.</span><span style="color:#a6e22e">setOutputPrintStream</span><span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">);</span>
        consoleLogger<span style="color:#f92672">.</span><span style="color:#a6e22e">setMessageOutputLevel</span><span style="color:#f92672">(</span>Project<span style="color:#f92672">.</span><span style="color:#a6e22e">MSG_INFO</span><span style="color:#f92672">);</span>

        <span style="color:#66d9ef">return</span> consoleLogger<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> Path <span style="color:#a6e22e">download</span><span style="color:#f92672">(</span>URL source<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        File target <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>REDIS_INSTALLATION_PATH<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(),</span> source<span style="color:#f92672">.</span><span style="color:#a6e22e">getPath</span><span style="color:#f92672">());</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>target<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Downloading : &#34;</span> <span style="color:#f92672">+</span> source <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; to &#34;</span> <span style="color:#f92672">+</span> target <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;...&#34;</span><span style="color:#f92672">);</span>
            FileUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">copyURLToFile</span><span style="color:#f92672">(</span>source<span style="color:#f92672">,</span> target<span style="color:#f92672">);</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Download complete&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Download skipped&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> target<span style="color:#f92672">.</span><span style="color:#a6e22e">toPath</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">install</span><span style="color:#f92672">(</span>Path downloadedFile<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Installing Redis into &#34;</span> <span style="color:#f92672">+</span> REDIS_INSTALLATION_PATH <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;...&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">final</span> TarGZipUnArchiver ua <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TarGZipUnArchiver<span style="color:#f92672">();</span>
            ua<span style="color:#f92672">.</span><span style="color:#a6e22e">setSourceFile</span><span style="color:#f92672">(</span>downloadedFile<span style="color:#f92672">.</span><span style="color:#a6e22e">toFile</span><span style="color:#f92672">());</span>
            ua<span style="color:#f92672">.</span><span style="color:#a6e22e">enableLogging</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ConsoleLogger<span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;console&#34;</span><span style="color:#f92672">));</span>
            ua<span style="color:#f92672">.</span><span style="color:#a6e22e">setDestDirectory</span><span style="color:#f92672">(</span>REDIS_INSTALLATION_PATH<span style="color:#f92672">.</span><span style="color:#a6e22e">toFile</span><span style="color:#f92672">());</span>
            ua<span style="color:#f92672">.</span><span style="color:#a6e22e">extract</span><span style="color:#f92672">();</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Done&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ArchiverException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Failure : &#34;</span> <span style="color:#f92672">+</span> e<span style="color:#f92672">);</span>
            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;!!! Unable to download and untar redis !!!&#34;</span><span style="color:#f92672">,</span> e<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">applyRedisPermissionRights</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
        File binDirectory <span style="color:#f92672">=</span> getFile<span style="color:#f92672">(</span>getInstallationDirectory<span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;src&#34;</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>String fn <span style="color:#f92672">:</span> REDIS_EXECUTABLE_FILE<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            File executableFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>binDirectory<span style="color:#f92672">,</span> fn<span style="color:#f92672">);</span>
            LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Applying executable permissions on &#34;</span> <span style="color:#f92672">+</span> executableFile<span style="color:#f92672">);</span>
            executableFile<span style="color:#f92672">.</span><span style="color:#a6e22e">setExecutable</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>Avec le fichier ant <code>build.xml</code> suivant :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
<span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;make&#34;</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;init&#34;</span> <span style="color:#a6e22e">basedir=</span><span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">&gt;</span>

    <span style="color:#f92672">&lt;target</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;init&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;echo</span> <span style="color:#a6e22e">message=</span><span style="color:#e6db74">&#34;Redis compilation is starting&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;exec</span> <span style="color:#a6e22e">command=</span><span style="color:#e6db74">&#34;make&#34;</span> <span style="color:#a6e22e">dir=</span><span style="color:#e6db74">&#34;${redisDirectory}&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;echo</span> <span style="color:#a6e22e">message=</span><span style="color:#e6db74">&#34;Redis compilation finished&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/target&gt;</span>
<span style="color:#f92672">&lt;/project&gt;</span>
</code></pre></div><p>Ainsi, en wrappant l&rsquo;appel dans un builder, il devient facile d&rsquo;invoquer l&rsquo;installeur.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> lombok.Builder<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> lombok.Data<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> java.io.File<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>

<span style="color:#a6e22e">@Data</span>
<span style="color:#a6e22e">@Builder</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EmbeddedRedisInstaller</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> String downloadUrl<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String version<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> String tmpDir<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> forceCleanupInstallationDirectory<span style="color:#f92672">;</span>

    RedisInstaller redisInstaller<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> EmbeddedRedisInstaller <span style="color:#a6e22e">install</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> InterruptedException <span style="color:#f92672">{</span>
        installRedis<span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">installRedis</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> InterruptedException <span style="color:#f92672">{</span>
        redisInstaller <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RedisInstaller<span style="color:#f92672">(</span>version<span style="color:#f92672">,</span> downloadUrl<span style="color:#f92672">,</span> forceCleanupInstallationDirectory<span style="color:#f92672">,</span> tmpDir<span style="color:#f92672">);</span>
        redisInstaller<span style="color:#f92672">.</span><span style="color:#a6e22e">install</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> File <span style="color:#a6e22e">getExecutableFile</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> redisInstaller<span style="color:#f92672">.</span><span style="color:#a6e22e">getExecutableFile</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>Utilisation de l&rsquo;installeur :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">EmbeddedRedisInstaller<span style="color:#f92672">.</span><span style="color:#a6e22e">builder</span><span style="color:#f92672">()</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;4.0.0&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">downloadUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;http://download.redis.io/releases/&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">forceCleanupInstallationDirectory</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">tmpDir</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;tmp/redis&#34;</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">()</span>
        <span style="color:#f92672">.</span><span style="color:#a6e22e">install</span><span style="color:#f92672">();</span>
</code></pre></div><p>Enfin, en le couplant, avec le projet <a href="https://github.com/ishiis/redis-unit">redis-unit</a>, il est possible de choisir son mode d&rsquo;utilisation tout en rendant configurable les ports :</p>
<pre><code>EmbeddedRedisInstaller installer = EmbeddedRedisInstaller.builder()
                .downloadUrl(downloadUrl)
                .forceCleanupInstallationDirectory(cleanupInstallation)
                .version(version)
                .tmpDir(tmpDir)
                .build();

try {
    installer.install();
} catch (IOException | InterruptedException e) {
    LOGGER.error(&quot;unable to install redis&quot;, e);
}

switch (type) {
    case SERVER:
        redisServer = new RedisServer(
                new RedisServerConfig.ServerBuilder(masterPort)
                        .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                        .build()
        );
        break;
    case CLUSTER:
        redisCluster = new RedisCluster(
                slavePorts.stream().map(p -&gt;
                        new RedisClusterConfig.ClusterBuilder(p)
                                .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                                .build()
                ).collect(Collectors.toList())
        );
        break;
    case MASTER_SLAVE:
        redisMasterSlave = new RedisMasterSlave(
                new RedisMasterSlaveConfig.MasterBuilder(masterPort)
                        .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                        .build(),
                slavePorts.stream().map(p -&gt;
                        new RedisMasterSlaveConfig.SlaveBuilder(p, masterPort)
                                .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                                .build()
                ).collect(Collectors.toList())
        );
        break;
    case SENTINEL:
        redisSentinel = new RedisSentinel(
                new RedisMasterSlaveConfig.MasterBuilder(masterPort)
                        .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                        .build(),
                slavePorts.stream().map(p -&gt;
                        new RedisMasterSlaveConfig.SlaveBuilder(p, masterPort)
                                .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                                .build()
                ).collect(Collectors.toList()),
                sentinelPorts.stream().map(p -&gt;
                        new RedisSentinelConfig.SentinelBuilder(p, masterPort)
                                .redisBinaryPath(installer.getExecutableFile().getAbsolutePath())
                                .build()
                ).collect(Collectors.toList())
        );
        break;
}
</code></pre><h1 id="conclusion">Conclusion</h1>
<p>On a pu voir dans cet article comment il était possible simplement d&rsquo;utiliser Redis lors de ses tests d&rsquo;intégration sans utiliser Docker et tout en pilotant la chose programmatiquement.</p>
<p>Pour retrouver le code, il est disponible à l'<a href="https://github.com/jetoile/hadoop-unit/tree/master/hadoop-unit-redis">url suivante</a>.</p>
<p>A noter qu&rsquo;il a été utilisé dans <a href="https://github.com/jetoile/hadoop-unit">Hadoop-Unit</a> et qu&rsquo;il est possible d&rsquo;utiliser Redis en test d&rsquo;intégration des manière suivantes ( #autopromo ;) ) :</p>
<ul>
<li>En utilisant le démarrage de <a href="https://github.com/jetoile/hadoop-unit/blob/master/hadoop-unit-redis/src/test/java/fr/jetoile/hadoopunit/RedisBootstrapTest.java">manière programmatique</a>:</li>
</ul>
<pre><code>@BeforeClass
public static void setup() throws BootstrapException {
    HadoopBootstrap.INSTANCE.startAll();
}

@AfterClass
public static void tearDown() throws BootstrapException {
    HadoopBootstrap.INSTANCE.stopAll();
}


@Test
public void testStartAndStopServerMode() throws InterruptedException {
    Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379);
    Assert.assertNotNull(jedis.info());
    System.out.println(jedis.info());
    jedis.close();
}
</code></pre><p>avec le pom suivant :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;dependency&gt;</span>
    <span style="color:#f92672">&lt;groupId&gt;</span>fr.jetoile.hadoop<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>hadoop-unit-redis<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>2.2<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;scope&gt;</span>test<span style="color:#f92672">&lt;/scope&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>

<span style="color:#f92672">&lt;dependency&gt;</span>
    <span style="color:#f92672">&lt;groupId&gt;</span>redis.clients<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>jedis<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>2.9.0<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;scope&gt;</span>test<span style="color:#f92672">&lt;/scope&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><p>et le fichier de configuration <code>hadoop-unit-default.properties</code> suivant:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain"># Redis
redis.port=6379
redis.download.url=http://download.redis.io/releases/
redis.version=4.0.0
redis.cleanup.installation=false
redis.temp.dir=/tmp/redis
redis.type=SERVER
#redis.type=CLUSTER
#redis.type=MASTER_SLAVE
#redis.type=SENTINEL
#redis.slave.ports=6380
#redis.sentinel.ports=36479,36480,36481,36482,36483
</code></pre></div><ul>
<li>En utilisant le plugin maven en <a href="https://github.com/jetoile/hadoop-unit/tree/master/sample/redis">phase de pré-integration</a>:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;plugin&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>hadoop-unit-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;groupId&gt;</span>fr.jetoile.hadoop<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>${hadoop-unit.version}<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;executions&gt;</span>
        <span style="color:#f92672">&lt;execution&gt;</span>
            <span style="color:#f92672">&lt;id&gt;</span>start<span style="color:#f92672">&lt;/id&gt;</span>
            <span style="color:#f92672">&lt;goals&gt;</span>
                <span style="color:#f92672">&lt;goal&gt;</span>embedded-start<span style="color:#f92672">&lt;/goal&gt;</span>
            <span style="color:#f92672">&lt;/goals&gt;</span>
            <span style="color:#f92672">&lt;phase&gt;</span>pre-integration-test<span style="color:#f92672">&lt;/phase&gt;</span>
        <span style="color:#f92672">&lt;/execution&gt;</span>
    <span style="color:#f92672">&lt;/executions&gt;</span>
    <span style="color:#f92672">&lt;configuration&gt;</span>
        <span style="color:#f92672">&lt;components&gt;</span>
            <span style="color:#f92672">&lt;componentArtifact</span> <span style="color:#a6e22e">implementation=</span><span style="color:#e6db74">&#34;fr.jetoile.hadoopunit.ComponentArtifact&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;componentName&gt;</span>REDIS<span style="color:#f92672">&lt;/componentName&gt;</span>
                <span style="color:#f92672">&lt;artifact&gt;</span>fr.jetoile.hadoop:hadoop-unit-redis:${hadoop-unit.version}<span style="color:#f92672">&lt;/artifact&gt;</span>
            <span style="color:#f92672">&lt;/componentArtifact&gt;</span>
        <span style="color:#f92672">&lt;/components&gt;</span>
    <span style="color:#f92672">&lt;/configuration&gt;</span>
<span style="color:#f92672">&lt;/plugin&gt;</span>
</code></pre></div>
  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.jetoile.fr%2f2017%2f07%2ftester-avec-redis.html" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://blog.jetoile.fr/2017/07/tester-avec-elasticsearch.html"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://blog.jetoile.fr/2017/07/tester-avec-elasticsearch.html">Des tests d&#39;intégration avec Elasticsearch</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://blog.jetoile.fr/2017/07/tester-avec-cassandra.html">Des tests d&#39;intégration avec Cassandra</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://blog.jetoile.fr/2017/07/tester-avec-cassandra.html"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'jetoile';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  

</div>

</div>
</div>
<script src="https://blog.jetoile.fr/js/ui.js"></script>
<script src="https://blog.jetoile.fr/js/menus.js"></script>




<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-11955429-1', 'auto');
    ga('send', 'pageview');
  }
</script>





<script src="https://blog.jetoile.fr/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

