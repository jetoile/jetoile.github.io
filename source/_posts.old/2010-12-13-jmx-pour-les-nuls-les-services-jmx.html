---
layout: post
title: "JMX pour les nuls... - Les services JMX - Partie 7"
date: 2010-12-13
comments: false
categories:
 - java
 - jmx
---

<div class='post'>
<div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TMdPuTpRY8I/AAAAAAAAALQ/R_w0PiLpvwo/s1600/jmx-cover.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TMdPuTpRY8I/AAAAAAAAALQ/R_w0PiLpvwo/s200/jmx-cover.png" width="171" /></a></div>Ce septième et avant dernier&nbsp;article sur JMX (cf. <a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-introduction.html">introduction</a>, <a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html">partie 1 portant sur les généralités</a>, <a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html">partie 2 portant sur les différents MBeans et le concept de Notification</a>, <a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-agents-jmx-partie.html">partie 3 sur les agents JMX</a>, <a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html">partie 4 sur les classes de base</a>, <a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-le-mbean-server.html">partie 5 sur le MBeanServer</a> et <a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-chargement-dynamique.html">partie 6 sur le chargement dynamique des MBeans</a>) abordera les différents types de services JMX.<br /><br /><br /><!-- more --><br /><br /><br /><br /><br /><h1>Table des matières</h1><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html">JMX, qu'est ce que c'est?</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#generalite">Généralités</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#architecture">Architecture JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#instrumentation">Niveau instrumentation</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#agent">Niveau agent</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#distribue">Niveau service distribué</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#composant">Composants JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#mbean">MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#notification">Modèle de notifications</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#metadonnee">Classe de métadonnées de MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#serveur">Serveur de MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#services">Service d'agents</a></li></ul></ul><li>Spécifications</li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html">JMX Instrumentation</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean">MBean</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_standard">MBean Standard</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_dynamic">Dynamic MBean</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#notification">Notification</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_open">Open MBean</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_model">Model MBean</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-agents-jmx-partie.html#agent">Agent JMX</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html">Concepts</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectname">ObjectName</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectinstance">ObjectInstance</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#attribute">Attribute et AttributeList</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#exception">Les Exceptions</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-le-mbean-server.html">MBean Server</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-chargement-dynamique.html">Chargement dynamique des MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html">Les services JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#monitoring">Service Monitoring</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#timer">Service Timer</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#relation">Service Relation</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#securite">Service Sécurité</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-connecteurs.html">Les Connecteurs</a></li></ul></ul>Le MBean Server propose, par défaut, un ensemble de fonctionnalités qui se présente sous forme de services JMX (ie. de MBeans), à savoir : <ul><li style="text-align: justify;">Service Monitoring</li><li style="text-align: justify;">Service Timer</li><li style="text-align: justify;">Service de relation</li><li style="text-align: justify;">Service de sécurité</li></ul><div><a name="monitoring"></a> <h2>Service Monitoring</h2><div><div><div style="text-align: justify;">Il existe une famille de MBeans de monitoring qui se présentent qui permettent de scrupter les variations au cours du temps de la valeur des attributs des autres MBeans et qui permet d'émettre des notifications à intervalle régulier. Ils sont aussi classifiés comme des services de monitoring.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">En fait, un service de monitoring (et donc un MBean de monitoring) permet d'observer la valeur d'un attribut donné présent dans un ou plusieurs MBeans (on dit qu'il s'agit alors du <b>MBean observé</b>) à un intervalle à régulier. Cette valeur peut être indifféremment la valeur d'un attribut ou la valeur contenue dans la valeur d'un attribut s'il est de type complexe. Pour chaque MBean observé, le moniteur interpole une seconde valeur qui est appelé le <b>pas dérivé</b> (<i>derived gauge</i>) et qui correspond, soit à la valeur observée, soit à la différence entre deux valeurs numériques obtenues consécutivement.</div></div><div><div style="text-align: justify;">Un type de notification spécifique est alors émis à chaque service de monitoring lorsque le pas dérivé répond à un ou un ensemble de conditions (ou lorsque certaines erreurs se produisent) qui peuvent être initialisées lors de l'initialisation du moniteur ou dynamiquement au travers de l'interface d'administration du MBean moniteur.&nbsp;</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">Il existe trois types de moniteurs :</div></div><div><ul><li style="text-align: justify;"><b>CounterMonitor</b> qui permet de scrupter des valeurs de type entier (<i>Byte</i>, <i>Integer</i>, <i>Short</i>, <i>Long</i>) et qui se comporte comme un compteur :</li><ul><li style="text-align: justify;">les valeurs ne peuvent être inférieures strictement à 0,</li><li style="text-align: justify;">les valeurs ne peuvent qu'être incrémentées,</li><li style="text-align: justify;">les valeurs peuvent être tournantes (dans ce cas un modulo doit être défini).</li></ul><li style="text-align: justify;"><b>GaugeMonitor</b> qui permet de scrupter des valeurs de types entier ou flottantes (<i>Float</i>, <i>Double</i>) et qui se comporte comme un pas</li><li style="text-align: justify;"><b>StringMonitor</b> qui permet de scrupter des valeurs de type <i>String</i>.</li></ul></div><div><div style="text-align: justify;">Tous ces moniteurs doivent étendre la classe abstraite <i>Monitor</i> alors que les types des valeurs surveillées doivent être supportés par le type de moniteur utilisé. Cependant, il est à noter que le moniteur vérifie le type de la valeur de l'instance retournée et non le te type de l'attribué déclaré dans les méta-données du MBean observé.</div></div></div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKLxHRkZAI/AAAAAAAAAP4/eZfErdqRqWE/s1600/jmx58.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKLxHRkZAI/AAAAAAAAAP4/eZfErdqRqWE/s400/jmx58.png" width="262" /></a></div><div><div style="text-align: justify;"></div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMExdR2sI/AAAAAAAAAP8/LvN1aDxsNIc/s1600/jmx59.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMExdR2sI/AAAAAAAAAP8/LvN1aDxsNIc/s400/jmx59.png" width="323" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMQ5MDK8I/AAAAAAAAAQA/sszqSpNWdeM/s1600/jmx60.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="387" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMQ5MDK8I/AAAAAAAAAQA/sszqSpNWdeM/s400/jmx60.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKNgMBobwI/AAAAAAAAAQI/NyLwm_9d4oc/s1600/jmx76.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="295" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKNgMBobwI/AAAAAAAAAQI/NyLwm_9d4oc/s400/jmx76.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: justify;"></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: justify;">Pour les notifications, une sous classe spécifique de <i>Notification</i> est définie pour être utilisée par tous les services de monitoring. Il s'agit de la classe <i>MonitorNotification</i>.&nbsp;</div><div class="separator" style="clear: both; text-align: justify;">Ainsi, elle est utilisée pour rapporter les cas suivants :</div><div class="separator" style="clear: both; text-align: left;"></div><ul><li style="text-align: justify;">Une condition de déclenchement d'un moniteur est détectée (par exemple, si le seuil d'une valeur est atteinte)</li><li style="text-align: justify;">Une erreur s'est produite durant la scrutation d'un attribut (par exemple, si un MBean est désenregistré)</li></ul><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKOjDQNWDI/AAAAAAAAAQM/qL7w59mPIcM/s1600/jmx77.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKOjDQNWDI/AAAAAAAAAQM/qL7w59mPIcM/s400/jmx77.png" width="312" /></a></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">La figure suivante représente tous les types de notifications qui peuvent être générées par un service Monitor.</div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKO0P3FAEI/AAAAAAAAAQQ/FSwyMlB4ryI/s1600/jmx57.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="222" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKO0P3FAEI/AAAAAAAAAQQ/FSwyMlB4ryI/s400/jmx57.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><a name="timer"></a> <h2>Service&nbsp;Timer</h2><div style="text-align: left;"><div style="text-align: left;"><div style="text-align: justify;">Le service Timer permet de déclencher des notifications à des dates et heures spécifiques ou à intervalles réguliers. Les notifications sont émises à tous les objets déclarés comme étant interessés par les notifications émises par le timer (patron <i>Observer</i>).&nbsp;</div></div><div style="text-align: left;"><div style="text-align: justify;">Le service Timer est un MBean qui peut être managé en permettant, entre autre, aux applications de modifier la configuration de son ordonnanceur (<i>scheduler</i>).</div></div><div style="text-align: left;"><div style="text-align: justify;">En fait, la classe Timer gère une liste de notifications datées qui sont émises quand leur date et heure arrivent. Les méthodes de cette classe permettent d'ajouter et de supprimer des notifications de sa liste. En fait, les types de notifications sont fournis par l'utilisateur avec la date et optionnellement la fréquence et le nombre de répétitions.</div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKPT0nrpwI/AAAAAAAAAQU/_P4QW-Dln5I/s1600/jmx64.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKPT0nrpwI/AAAAAAAAAQU/_P4QW-Dln5I/s400/jmx64.png" width="330" /></a></div><div style="text-align: left;"><div style="text-align: justify;"></div></div><div style="text-align: left;"><div style="text-align: left;"><div style="text-align: justify;">Pour les notifications, une sous classe spécifique de <i>Notification</i> est définie pour être utilisée par le service Timer. Il s'agit de la classe <i>TimerNotification</i>.&nbsp;</div></div><div style="text-align: left;"><div style="text-align: justify;">Ainsi, elle est utilisée pour rapporter les cas suivants :</div></div><div style="text-align: left;"><ul><li style="text-align: justify;">Les notifications ne sont déclenchées qu'une seule fois</li><li style="text-align: justify;">Les notifications sont répétées à une période définie et/ou un nombre d'occurrences</li></ul></div><div style="text-align: left;"><div style="text-align: justify;">Ces paramètres sont définis lorsque la notification est ajoutée à la liste de notifications du timer. En outre, à chacune des notifications émises est associée un identifiant unique.</div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKPwGfdiTI/AAAAAAAAAQY/YNQBbw48Vsw/s1600/jmx61.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKPwGfdiTI/AAAAAAAAAQY/YNQBbw48Vsw/s400/jmx61.png" width="237" /></a></div></div><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKO0P3FAEI/AAAAAAAAAQQ/FSwyMlB4ryI/s1600/jmx57.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"></a> <div style="text-align: justify;"></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Si la notification ajoutée au service Timer possède une date antérieure à la date courante, alors la méthode <i>addNotification</i> se comporte comme si la date indiquée était la date courante.</td></tr></tbody></table><div style="text-align: justify;"></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Si la date d'émission d'une notification est mise à jour alors qu'elle est déjà existante, alors aucune notification de mise à jour n'est émise.</td></tr></tbody></table><div style="text-align: justify;"></div><div style="text-align: justify;">Le service Timer MBean est un émetteur standard de notifications (qui possèdent un type et une date définis dans la liste de notifications ajoutées à l'aide de la méthode <i>addNotification()</i>). Tous les écouteurs d'un MBean Timer donnés reçoivent toutes les notifications. Les écouteurs interessés par un type de notifications Timer particulier doivent spécifier un objet filtre lors de leur enregistrement.</div><div style="text-align: justify;">Lorsqu'un timer est actif et que la date d'une notification de type Timer arrive à son terme, le service Timer émet cette notification en fournissant son type, message, données utilisateurs ainsi que l'identifiant de la notification. S'il s'agit d'une notification périodique disposant d'un nombre d'occurrence, il est décrémenté.</div><div style="text-align: justify;"></div><div style="text-align: justify;">Enfin, si la notification n'a plus besoin d'être émise (notification non récurente ou notification périodique disposant d'un nombre d'émission prédéfini), elle est supprimée de la liste des notifications.</div><div style="text-align: justify;"></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Si une notification dispose d'une date d'émission antérieure à son démarrage, il est possible de l'émettre ou de l'ignorer à l'aide de la méthode <i>sendPastNotification()</i>. Par défaut, la valeur de cet attribut est mise à <i>false</i>.</td></tr></tbody></table><div><a name="relation"></a> <h2>Service Relation</h2><div><div><div style="text-align: justify;">JMX définit un modèle de relation entre les MBeans. Une relation est définie par l'utilisateur et se présente comme une association n-aire entre les MBeans.&nbsp;</div></div><div><div style="text-align: justify;">Pour ce faire, JMX propose un ensemble de classes à utiliser pour décrire les relations, ainsi qu'un service qui permet de centraliser toutes les opérations de mise en relation.&nbsp;</div></div><div><div style="text-align: justify;">Toutes les relations permettent d'associer un type de relations (qui fournit des informations sur les rôles qu'il contient comme la multiplicité) avec le nom de classe du MBean qui satisfait le rôle.&nbsp;</div></div><div><div style="text-align: justify;">Le service de relations permet également de chercher un MBean au travers de ses relations.</div></div><div><div style="text-align: justify;">Il est garant de la consistance des relations en vérifiant les opérations et le désenregistrement des MBean afin de s'assurer que les relations sont toujours conformes. Si une relation n'est plus valide, elle est supprimée du service de relations même si ses MBeans membres restent présents.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">Une relation est composée de rôles nommés qui disposent d'une liste de MBeans associés à ce rôle. Cette liste doit être consistante avec les informations de multiplicité ainsi qu'avec les classes des MBean qui représentent ce rôle.&nbsp;</div></div><div><div style="text-align: justify;">Un ensemble de définition de rôles constitue un type de relation.</div></div><div><div style="text-align: justify;">Un type de relation est un patron pour toutes les instances de relations qui associent les MBeans représentant ses rôles.</div></div><div><div style="text-align: justify;">Par la suite, le terme de relation signifiera une instance spécique d'une relation associant des MBeans existants aux rôles dans un type de relations défini.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">Le tableau ci-dessous décrit les concepts nécessaires à la compréhension du modèle de relations défini par JMX :</div></div></div><div><div style="text-align: justify;"></div></div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><th align="center">Concept</th> <th align="center">Description</th></tr><tr><td>Role information</td> <td>Décrit un des rôles dans une relation. L'information sur un rôle est composée du nom du rôle, de sa multiplicité, du nom de la classe qui participe à ce rôle, d'une propriété en lecture-seule sur les permissions et d'une description.</td></tr><tr><td>Relation type</td> <td>Méta-donnée d'une relation, composée d'un ensemble de Role information. Permet de décrire les rôles qu'une relation satisfait et permet de servir de patron pour créer et maintenir des relations.</td></tr><tr><td>Relation</td> <td>Association courante entre des MBeans qui satisfont une relation donnéee. Une relation peut avoir des propriétés et méthodes qui ne s'appliquent qu'à ses MBeans.</td></tr><tr><td>Role Value</td> <td>Liste de MBeans qui satisfont un rôle donné dans une relation.</td></tr><tr><td>Unresolved Role</td> <td>Résultat d'un accès illégal d'une opération sur un rôle. Contient la raison du refus de l'opération.</td></tr><tr><td>Support Classes</td> <td>Classes internes utilisées pour représenter des types de relations et des instances de relations.</td></tr><tr><td>Relation Service</td> <td><span style="font-family: Tahoma, sans-serif; font-size: 10pt;">MBean qui peut accéder et maintenir la consistance de tous les types de relations et toutes les instances de relations dans un agent JMX. Fournit des opérations pour trouver un MBean et ses rôles dans une relation.</span></td></tr></tbody></table><div><div style="text-align: justify;"></div></div><div><div><div style="text-align: justify;">En JMX, le type de relation est un ensemble statique de rôles. Les types de relations peuvent être définis à l'exécution mais, une fois défini, ces rôles et informations sur les rôles ne peuvent être modifiés.&nbsp;</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;"><u>Exemple de relations :</u></div></div><div><div style="text-align: justify;">Dans cet exemple, des livres (<i>Books</i>) et les propriétaires (<i>Owner</i>) représente des rôles :&nbsp;</div></div><div><ul><li style="text-align: justify;"><i>Books</i> représente le nombre de livres que possède la classe d'un MBean donnée.&nbsp;</li><li style="text-align: justify;"><i>Owner</i> représente un propriétaire de livres d'une autre classe d'un MBean.</li></ul></div><div><div style="text-align: justify;">Un type de relations (<i>Personal Library</i>) peut être défini comme étant la notion d'appartenance de livres.</div></div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKRennmH-I/AAAAAAAAAQg/l79ynOUIw8k/s1600/jmx65.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="160" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKRennmH-I/AAAAAAAAAQg/l79ynOUIw8k/s400/jmx65.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: justify;"></div><div><div><div style="text-align: justify;">En fait, le service de relations empêche la création de types de relations invalides, de relations invalides ou la modifiation de valeurs de rôles invalides.</div></div><div><div style="text-align: justify;">Quand une relation est supprimée du service de relations, ses MBeans membres ne sont pas impactés.</div></div><div><div style="text-align: justify;">Quand un type de relation est supprimé, toutes les relations référencées sont au préalable supprimées. Cependant, c'est à l'appelant de gérer la consistance lors de la suppression d'un type de relations.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">En outre, puisque les relations ne sont définies qu'au niveau des MBeans enregistrés, en supprimer un de l'annuaire est susceptible de modifier la relation. Le service de relations écoute, pour tous les MBean, le server de notifications qui indique quand un membre d'une relation est désenregistré. Le MBean correspondant est alors supprimé de tous rôles où il se trouve. Dans le cas où la nouvelle cardinalité du rôle n'est pas consistante avec son type de relation, alors la relation est supprimée du service de relation.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">Le service de relations émet des notifications après l'exécution d'opérations qui modifient une instance de relations (création, mise à jour ou suppression). Cette notification fournit des informations sur la modification comme l'identifiant de la relation et la nouvelle valeur d'un rôle.</div></div><div><div style="text-align: justify;"></div></div><div><div style="text-align: justify;">De plus, il est à noter qu'il existe deux types de relations et relations :</div></div><div><ul><li style="text-align: justify;">Les types de relations et relations internes : les types de relations et leurs instances sont créés par le service de relations et ne sont accessibles qu'aux travers ses opéraitons.&nbsp;</li><li style="text-align: justify;">Les types de relations et relations externes : les types de relations et leurs instances sont instanciés en dehors du service de relations puis lui sont ajoutés. Dans ce cas, ils peuvent être accessibles directement et, en l'occurrence, peuvent être enregistré comme des MBeans. Il est cependant à noter que ces types de relation sont immuables et qu'elles ne doivent pas être modifiées une fois enregistré dans le service de relation.</li></ul></div></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>En raison de la complexité de ce service, pour plus d'informations, il est préférable de se référer aux chapitres <i>11.2 Relation Service Classes</i>, <i>11.3 Interfaces and Support Classes</i> et <i>11.4 Role Description Classes</i> des spécifications agrégées JMX.</td></tr></tbody></table></div><div><a name="securite"></a> <h2>Service Securité</h2><div><div style="text-align: justify;">Un MBean Server JMX peut avoir accès à des informations sensibles et peut être susceptible d'exposer des opérations sensibles. Pour ce faire, JMX propose un mécanisme d'accès à de telles opérations en s'appuyant sur le modèle de sécurité de Java : il est possible de définir des permissions qui permettent de&nbsp;contrôler&nbsp;l'accès au MBean Server et à ses opérations.</div><div style="text-align: justify;"></div></div></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>La sécurisation du MBean Server s'appuyant sur le modèle standard de sécurité Java, il est nécessaire de disposer du gestionnaire de sécurité Java (<i>security manager</i>). La méthode statique <i>System.getSecurityManager()</i> permet de le vérifier.</td></tr></tbody></table><div style="text-align: justify;"></div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Pour rappel, le modèle de sécurité de Java s'appuie sur le principe de permissions : pour qu'une opération soit invocable, l'appelant doit posséder la/les permissions.<br />En effet, à un point donné de l'exécution d'un programme correspond un ensemble de permissions appliqué à l'exécution d'un thread. <br />En fait, une opération est autorisée si le thread qui l'invoque dispose des permissions nécessaires.<br /><br />Les permissions sont des objets java qui étendent la classe <i>Permission</i>.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKS5FhDvOI/AAAAAAAAAQk/QbB4KTZsUXA/s1600/jmx66.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="263" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKS5FhDvOI/AAAAAAAAAQk/QbB4KTZsUXA/s320/jmx66.png" width="320" /></a></div></td></tr></tbody></table><div style="text-align: justify;"></div><div><div style="text-align: justify;">En fait, JMX défini, par défaut, sa propre permission <i>MBeanServerPermission</i> qui peut être configurée comme suit :</div><ul><li style="text-align: justify;"><i>MBeanServerPermission</i> qui prend en paramètre de son constructeur une chaine de caractère représentant la liste des opérations autorisées sur le MBeanServer (ex : <i>MBeanServerPermission("createMBeanServer")</i> qui permet de controler l'accès aux méthodes <i>MBeanServerFactory.createMBeanServer</i> )</li><li style="text-align: justify;"><i>MBeanPermission</i> qui prend en paramètre deux chaines de caractères :</li><ul><li style="text-align: justify;">la première représente la cible et peut être composée du nom canonique de la classe ou d'une expression régulière, du membre (c'est-à-dire le nom de l'attribut ou de l'opération qui doit être accédé), et de l'ObjetName du MBean cible.&nbsp;</li></ul></ul><div style="text-align: justify;"><u>Exemples de cible :</u></div><div><pre class="brush:java; wrap-lines: false; auto-links: false" style="text-align: justify;">com.example.Resource#Name[com.example.main:type=resource]<br />com.example.Resource#*[com.example.main:type=resource]<br />*#Name[com.example.main:type=resource]</pre><div><div><ul><ul><li style="text-align: justify;">la &nbsp;deuxième représente l'action une ou plusieurs méthodes du MBean Server parmi les suivantes :</li><ul><li style="text-align: justify;"><i>addNotificationListener</i></li><li style="text-align: justify;"><i>getAttribute</i></li><li style="text-align: justify;"><i>getClassLoader</i></li><li style="text-align: justify;"><i>getClassLoaderFor</i></li><li style="text-align: justify;"><i>getClassLoaderRepository</i></li><li style="text-align: justify;"><i>getMBeanInfo</i></li><li style="text-align: justify;"><i>getObjectInstance</i></li><li style="text-align: justify;"><i>instantiate</i></li><li style="text-align: justify;"><i>invoke</i></li><li style="text-align: justify;"><i>isInstanceOf</i></li><li style="text-align: justify;"><i>queryMBeans</i></li><li style="text-align: justify;"><i>queryNames</i></li><li style="text-align: justify;"><i>registerMBean</i></li><li style="text-align: justify;"><i>removeNotificationListener</i></li><li style="text-align: justify;"><i>setAttribute</i></li><li style="text-align: justify;"><i>unregisterMBean</i></li></ul></ul></ul></div></div><div><table border="1" cellpadding="0" cellspacing="0" style="margin-left: 0px; margin-right: 0px; text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Les opérations suivantes ne sont pas soumises à la sécurisation du MBean Server :<br /><ul><li><i>isRegistered</i></li><li><i>getMBeanCount</i></li><li><i>getDefaultDomain</i></li></ul></td></tr></tbody></table></div><div style="text-align: justify;"></div><div style="text-align: justify;">De plus, JMX propose la permission <i>MBeanTrustPermission</i> qui permet de faire confiance à un certain utilisateur ou code source signé. Si le signataire ou le code source possède cette permission, le MBean est considéré comme étant de confiance. Seuls les MBeans de confiance peuvent alors être enregistrés dans le MBean Server.</div><div style="text-align: justify;">Une permission <i>MBeanTrustPermission</i> est configurée soit avec la valeur "<i>register</i>", soit avec la valeur &nbsp;"<i>*</i>" qui signifient toutes deux la même chose dans la version courante de la version JMX.</div><div style="text-align: justify;"></div><div style="text-align: justify;">Ainsi, utilisé en complément de la permission <i>MBeanPermission</i>, la permission <i>MBeanTrustPermission</i> permet une gestion de la sécurité plus fine sur l'enregistrement des MBeans : la permission <i>MBeanPermission</i> vérifie qui enregistre alors que la permission <i>MBeanTrustPermission</i> vérifie ce qui est enregistré.</div><div style="text-align: justify;"></div><div style="text-align: justify;"><u>Exemples de fichier de policy :</u></div><pre class="brush:java; wrap-lines: false; auto-links: false">grant {<br />    permission javax.management.MBeanPermission "*", "*";<br />};<br /><br />grant codeBase "file:${user.dir}${/}appl1.jar" {<br />    permission javax.management.MBeanPermission "", "getClassLoaderRepository";<br />};<br /><br />grant codeBase "file:${user.dir}${/}appl2.jar" {<br />    permission javax.management.MBeanPermission "[d1:*]", "isInstanceOf, getObjectInstance";<br />};<br /><br />grant codeBase "file:${user.dir}${/}appl3.jar" {<br />    permission javax.management.MBeanServerPermission "findMBeanServer";<br />    permission javax.management.MBeanPermission "JMImplementation:*", "queryNames";<br />};<br /><br />grant {<br />    permission javax.management.MBeanTrustPermission "register";<br />};<br /><br />grant signedBy "Gorey" {<br />    permission javax.management.MBeanTrustPermission "register";<br />};<br /><br /></pre><div><div style="text-align: justify;"></div></div></div></div></div></div></div>
