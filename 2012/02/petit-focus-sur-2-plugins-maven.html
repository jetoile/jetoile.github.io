<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.111.3">

  <title>Petit focus sur 2 plugins Maven &middot; Jetoile</title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://blog.jetoile.fr/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://blog.jetoile.fr/css/blackburn.css">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet" type="text/css">

  
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css">
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  
  <script async src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/languages/yaml.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://blog.jetoile.fr/img/favicon.ico" type="image/x-icon" />

  
    
        <link rel="stylesheet" href="https://blog.jetoile.fr/css/my.css">
    
  
  
    
        <script src="https://blog.jetoile.fr/js/my.js"></script>
    
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://blog.jetoile.fr/">Jetoile</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/post.html"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/about.html"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/contact.html"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://blog.jetoile.fr/hadoop-unit"><i class='fa fa-list fa-fw'></i>Hadoop Unit</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/jetoile" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/jetoile" rel="me" target="_blank"><i class="fab fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/khanh-tuong-maudoux-11b92b19" rel="me" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/jetoile" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small><a href='http://creativecommons.org/licenses/by/4.0/' rel='license'><img alt='Licence Creative Commons' src='https://blog.jetoile.fr/images/creative_common88x31.png' style='border-width:0'/></a></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Petit focus sur 2 plugins Maven</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Feb 2012</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/int%C3%A9gration-continue">intégration continue</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/java">java</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://blog.jetoile.fr/tags/maven">maven</a>
    
  </div>
  
  

</div>

  <p><img src="http://1.bp.blogspot.com/-l-NZQRxE0vI/TevA5LfJQ_I/AAAAAAAAAXI/IP8zRk4wbeg/s1600/maven-logo-2.gif" alt="left-small"></p>
<p>Bon, ça fait un moment que je n&rsquo;ai rien écrit&hellip; je n&rsquo;ai pas foncièrement d&rsquo;excuses si ce n&rsquo;est que j&rsquo;ai été pas mal occupé sur un projet sur lequel j&rsquo;essaierai de faire un petit retour dans un futur proche&hellip;</p>
<p>En fait, dans ce rapide post, je tenais à faire partager 2 &ldquo;petits&rdquo; plugins maven que j&rsquo;ai eu l&rsquo;opportunité de découvrir récemment par le biais de 2 Olivier :</p>
<ul>
<li><a href="http://twitter.com/olamy">Olivier Lamy</a> (<a href="http://olamy.blogspot.com/)">http://olamy.blogspot.com/)</a>, qui est architecte open source et commiteur actif de moultes projets (je ne les citerai pas, il y en a trop&hellip; ;-) ) <del>et qui travaille chez Talend</del>,</li>
<li>et <a href="http://twitter.com/obazoud">Olivier Bazoud</a> (<a href="http://blog.bazoud.com/">http://blog.bazoud.com/</a>) <del>qui est architecte chez Ekino et également</del> co-auteur du livre <a href="http://www.manning.com/templier/">Spring Batch In Action</a> aux éditions Manning.</li>
</ul>
<p>Les deux plugins sont les suivants :</p>
<ul>
<li><a href="http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/tomcat7-maven-plugin/plugin-info.html">Tomcat 7 Maven Plugin</a></li>
<li><a href="http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/">Application Assembler Maven Plugin</a></li>
</ul>
<p>En fait, je ne rentrerai pas en détail dans les 2 plugins Maven qui, pour un, est assez connu mais je me contenterai juste de décrire les fonctionnalités que j&rsquo;ai appréciées.</p>
<p>N&rsquo;étant pas expert sur ces derniers et n&rsquo;ayant pas creusé dans tous les paramétrages, j&rsquo;espère que la présentation qui suit ne dira pas trop de bêtises&hellip; ;-)</p>
<!-- more -->
<h1 id="application-assembler-maven-plugin">Application Assembler Maven Plugin</h1>
<h2 id="description">Description</h2>
<p>[Cette description est une traduction libre de la page officielle du plugin]</p>
<p>Le plugin Application Assembler est un plugin maven qui permet de générer les scripts utilisés au démarrage d&rsquo;une application Java. Pour ce faire, le plugin copie toutes les dépendances et les artifacts du projet dans un répertoire utilisé par le script pour la gestion du classpath de l&rsquo;application à démarrer.</p>
<p>Les plateformes actuellement supportées sont :</p>
<ul>
<li>*Nix,</li>
<li>Windows NT</li>
<li>Java Service Wrapper</li>
</ul>
<h2 id="cas-dutilisation">Cas d&rsquo;utilisation</h2>
<p>Ce plugin trouve parfaitement sa place pour générer les scripts d&rsquo;exécution d&rsquo;une application java standalone (ie. non exécuté au sein d&rsquo;un conteneur de servlet ou d&rsquo;un serveur d&rsquo;application) ou utilisée dans un batch.
En fait, pour être plus précis, ce plugin dispose de 3 goals :</p>
<ul>
<li><code>appassembler:assemble</code> qui permet de créer une arborescence de fichiers disposant des scripts de lancement de l&rsquo;application ainsi que de toutes les dépendances nécessaires à son exécution.</li>
<li><code>appassembler:create-repository</code> qui permet de créer le répertoire disposant de toutes les librairies nécessaires au bon fonctionnement de l&rsquo;application.</li>
<li><code>appassembler:generate-daemons</code> qui permet de créer une arborescence de fichiers disposant des scripts et des librairies à utiliser pour wrapper l&rsquo;application dans un service via Java Service Wrapper.</li>
</ul>
<h2 id="exemple">Exemple</h2>
<p>Pour montrer comment peut être utilisé ce plugin, je vais prendre un projet simple (accessible sur mon <a href="http://github.com/jetoile/sample-assembler-plugin">github</a>) qui ne contient qu&rsquo;une classe disposant d&rsquo;un main et qui log un message via logback au travers de slf4j (histoire de vérifier le comportement du plugin sur les dépendances).</p>
<p><img src="http://1.bp.blogspot.com/-Dr-0c8AkLHs/T0tyqJW4UVI/AAAAAAAAAiY/A7dW1I3ve4Q/s1600/appassembler01.png" alt="center"></p>
<p>où on a :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.jetoile.maven.sample<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.slf4j.Logger<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.slf4j.LoggerFactory<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FooClass</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Logger LOGGER <span style="color:#f92672">=</span> LoggerFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getLogger</span><span style="color:#f92672">(</span>FooClass<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        </span>LOGGER<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;this is FooClass sample&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>Cet exemple a pour objectif de montrer, dans un premier temps, ce que génère le goal assemble puis, dans un second temps, le goal <code>generate-daemons</code>.</p>
<p>Pour ce faire, le pom.xml suivant sera utilisé :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">         </span><span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">         </span><span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>com.jetoile.maven.sample<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>sample-assembler-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span style="color:#f92672">&lt;/project.build.sourceEncoding&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;projectBaseUri&gt;</span>${project.baseUri}<span style="color:#f92672">&lt;/projectBaseUri&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;java.version&gt;</span>1.6<span style="color:#f92672">&lt;/java.version&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;slf4j.version&gt;</span>1.6.4<span style="color:#f92672">&lt;/slf4j.version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;logback.version&gt;</span>1.0.0<span style="color:#f92672">&lt;/logback.version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/properties&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>org.slf4j<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>slf4j-api<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>${slf4j.version}<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>ch.qos.logback<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>logback-classic<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>${logback.version}<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;scope&gt;</span>runtime<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;plugins&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>maven-compiler-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>2.3.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;source&gt;</span>${java.version}<span style="color:#f92672">&lt;/source&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;target&gt;</span>${java.version}<span style="color:#f92672">&lt;/target&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>appassembler-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>1.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;daemons&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;daemon&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;id&gt;</span>mainService<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;mainClass&gt;</span>com.jetoile.maven.sample.FooClass<span style="color:#f92672">&lt;/mainClass&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;commandLineArguments&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;commandLineArgument&gt;</span>start<span style="color:#f92672">&lt;/commandLineArgument&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/commandLineArguments&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;platforms&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;platform&gt;</span>jsw<span style="color:#f92672">&lt;/platform&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/platforms&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;generatorConfigurations&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;generatorConfiguration&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;generator&gt;</span>jsw<span style="color:#f92672">&lt;/generator&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;includes&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;include&gt;</span>linux-x86-32<span style="color:#f92672">&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;include&gt;</span>linux-x86-64<span style="color:#f92672">&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;/includes&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;/generatorConfiguration&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/generatorConfigurations&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/daemon&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/daemons&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>appassembler-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>1.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;executions&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;goal&gt;</span>assemble<span style="color:#f92672">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/executions&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;programs&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;program&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;mainClass&gt;</span>com.jetoile.maven.sample.FooClass<span style="color:#f92672">&lt;/mainClass&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;name&gt;</span>main<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/program&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/programs&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;binFileExtensions&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;unix&gt;</span>.sh<span style="color:#f92672">&lt;/unix&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/binFileExtensions&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/plugins&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/build&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/project&gt;</span>
</span></span></code></pre></div><p>Dans le pom, on constate que l&rsquo;exécution du goal <code>assemble</code> n&rsquo;est pas associé à une phase en particulier. Cependant, c&rsquo;est la phase <code>package</code> qui est utilisée par défaut. Dans sa configuration (disponible <a href="http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/assemble-mojo.html">ici</a>), il y figure le nom de la classe qui dispose du <code>main</code> ainsi que, via l&rsquo;élément <code>binFileExtensions</code>, l&rsquo;extension qui doit être utilisée pour le script dans le monde *Nix.</p>
<p>Ainsi, à la commande suivante :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn package
</span></span></code></pre></div><p>on obtient :
<img src="http://4.bp.blogspot.com/-6TcmRrHkwm8/T0uMn3oeh5I/AAAAAAAAAio/VyNjedWdxm8/s1600/appassembler03.png" alt="medium"></p>
<p>où le <code>main.sh</code> est le suivant :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># ----------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  Copyright 2001-2006 The Apache Software Foundation.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  you may not use this file except in compliance with the License.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  You may obtain a copy of the License at</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#       http://www.apache.org/licenses/LICENSE-2.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  Unless required by applicable law or agreed to in writing, software</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  See the License for the specific language governing permissions and</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  limitations under the License.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ----------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   Copyright (c) 2001-2006 The Apache Software Foundation.  All rights</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   reserved.</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>BASEDIR<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>dirname $0<span style="color:#e6db74">`</span>/..
</span></span><span style="display:flex;"><span>BASEDIR<span style="color:#f92672">=</span><span style="color:#e6db74">`</span><span style="color:#f92672">(</span>cd <span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span>; pwd<span style="color:#f92672">)</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># OS specific support.  $var _must_ be set to either true or false.</span>
</span></span><span style="display:flex;"><span>cygwin<span style="color:#f92672">=</span>false;
</span></span><span style="display:flex;"><span>darwin<span style="color:#f92672">=</span>false;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;`uname`&#34;</span> in
</span></span><span style="display:flex;"><span>  CYGWIN*<span style="color:#f92672">)</span> cygwin<span style="color:#f92672">=</span>true ;;
</span></span><span style="display:flex;"><span>  Darwin*<span style="color:#f92672">)</span> darwin<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>           if <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$JAVA_VERSION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>             JAVA_VERSION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CurrentJDK&#34;</span>
</span></span><span style="display:flex;"><span>           else
</span></span><span style="display:flex;"><span>             echo <span style="color:#e6db74">&#34;Using Java version: </span>$JAVA_VERSION<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>           fi
</span></span><span style="display:flex;"><span>           if <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>             JAVA_HOME<span style="color:#f92672">=</span>/System/Library/Frameworks/JavaVM.framework/Versions/<span style="color:#e6db74">${</span>JAVA_VERSION<span style="color:#e6db74">}</span>/Home
</span></span><span style="display:flex;"><span>           fi
</span></span><span style="display:flex;"><span>           ;;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  if <span style="color:#f92672">[</span> -r /etc/gentoo-release <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    JAVA_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>java-config --jre-home<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  fi
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For Cygwin, ensure paths are in UNIX format before anything is touched</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> $cygwin ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> JAVA_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --unix <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$CLASSPATH<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> CLASSPATH<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --unix <span style="color:#e6db74">&#34;</span>$CLASSPATH<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If a specific java binary isn&#39;t specified search for the standard &#39;java&#39; binary</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$JAVACMD<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  if <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span>  <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">/jre/sh/java&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># IBM&#39;s JDK on AIX uses strange locations for the executables</span>
</span></span><span style="display:flex;"><span>      JAVACMD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">/jre/sh/java&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>      JAVACMD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">/bin/java&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  else
</span></span><span style="display:flex;"><span>    JAVACMD<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>which java<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  fi
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -x <span style="color:#e6db74">&#34;</span>$JAVACMD<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;Error: JAVA_HOME is not defined correctly.&#34;</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;  We cannot execute </span>$JAVACMD<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  REPO<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span>/repo
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>CLASSPATH<span style="color:#f92672">=</span>$CLASSPATH_PREFIX:<span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span>/etc:<span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span>/org/slf4j/slf4j-api/1.6.4/slf4j-api-1.6.4.jar:<span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span>/ch/qos/logback/logback-classic/1.0.0/logback-classic-1.0.0.jar:<span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span>/ch/qos/logback/logback-core/1.0.0/logback-core-1.0.0.jar:<span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span>/com/jetoile/maven/sample/sample-assembler-plugin/1.0-SNAPSHOT/sample-assembler-plugin-1.0-SNAPSHOT.jar
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>EXTRA_JVM_ARGUMENTS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For Cygwin, switch paths to Windows format before running java</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> $cygwin; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$CLASSPATH<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> CLASSPATH<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --windows <span style="color:#e6db74">&#34;</span>$CLASSPATH<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> JAVA_HOME<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --windows <span style="color:#e6db74">&#34;</span>$JAVA_HOME<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> HOME<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --windows <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> BASEDIR<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --windows <span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> REPO<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cygpath --path --windows <span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>exec <span style="color:#e6db74">&#34;</span>$JAVACMD<span style="color:#e6db74">&#34;</span> $JAVA_OPTS <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  $EXTRA_JVM_ARGUMENTS <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -classpath <span style="color:#e6db74">&#34;</span>$CLASSPATH<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -Dapp.name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;main&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -Dapp.pid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$$<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -Dapp.repo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$REPO<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -Dbasedir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$BASEDIR<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  com.jetoile.maven.sample.FooClass <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Après un rapide :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x target/appassembler/bin/main.sh
</span></span></code></pre></div><p>Le résultat escompté est obtenu.</p>
<p>Afin de tester la génération de la couche wrapper <strong>Java Service Wrapper</strong>, le <code>pom.xml</code> contient également la déclaration du plugin <strong>appassembler-maven-plugin</strong> associé aux paramètres de configuration nécessaire à la génération du service. Pour cette partie, j&rsquo;ai choisi de ne pas l&rsquo;associer à une phase mais de l&rsquo;exécuter manuellement :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>appassembler-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>1.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;daemons&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;daemon&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;id&gt;</span>mainService<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;mainClass&gt;</span>com.jetoile.maven.sample.FooClass<span style="color:#f92672">&lt;/mainClass&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;commandLineArguments&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;commandLineArgument&gt;</span>start<span style="color:#f92672">&lt;/commandLineArgument&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/commandLineArguments&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;platforms&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;platform&gt;</span>jsw<span style="color:#f92672">&lt;/platform&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/platforms&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;generatorConfigurations&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;generatorConfiguration&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;generator&gt;</span>jsw<span style="color:#f92672">&lt;/generator&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;includes&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;include&gt;</span>linux-x86-32<span style="color:#f92672">&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;include&gt;</span>linux-x86-64<span style="color:#f92672">&lt;/include&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;/includes&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;/generatorConfiguration&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/generatorConfigurations&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/daemon&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/daemons&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span></code></pre></div><p>Ainsi, après l&rsquo;exécution de la commande :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn appassembler:generate-daemons
</span></span></code></pre></div><p>on obtient :
<img src="http://2.bp.blogspot.com/-zDcT-L4IP74/T0uawGcSPCI/AAAAAAAAAiw/j8giu9U41wI/s1600/appassembler04.png" alt="medium"></p>
<p>Cependant, après un rapide chmod sur les fichiers <code>mainService</code> et <code>wrapper-linux-x86-64</code>, la première tentative d&rsquo;exécution échoue&hellip;  :(</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x target/generated-resources/appassembler/jsw/mainService/bin/mainService
</span></span><span style="display:flex;"><span>chmod +x target/generated-resources/appassembler/jsw/mainService/bin/wrapper-linux-x86-64
</span></span><span style="display:flex;"><span>./target/generated-resources/appassembler/jsw/mainService/bin/mainService start
</span></span></code></pre></div><p><img src="http://2.bp.blogspot.com/-RJ0R6CrTvU8/T0uczKHGWqI/AAAAAAAAAi4/gd7ftUBeKh8/s1600/appassembler05.png" alt="medium"></p>
<p>Un rapide coup d&rsquo;oeil au fichier <code>wrapper.log</code>&hellip; :'(</p>
<p>Qu&rsquo;à cela ne tienne, s&rsquo;il n&rsquo;y manque le répertoire logs, il suffit de le créer&hellip;</p>
<p><img src="http://3.bp.blogspot.com/-VQFurPRDpUI/T0udmE8zNvI/AAAAAAAAAjA/LBpih32n8XI/s1600/appassembler06.png" alt="large"></p>
<p>Arf&hellip; encore loupé&hellip;</p>
<p>A priori, il semble que le classpath soit on ne peut plus&hellip; foireux&hellip;</p>
<p>Après un rapide coup d&rsquo;oeil au fichier <code>wrapper.conf</code>,  on peut remarquer les lignes suivantes :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>wrapper.java.mainclass=org.tanukisoftware.wrapper.WrapperSimpleApp
</span></span><span style="display:flex;"><span>set.default.REPO_DIR=repo
</span></span><span style="display:flex;"><span>set.default.APP_BASE=.
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span># Java Classpath (include wrapper.jar)  Add class path elements as
</span></span><span style="display:flex;"><span>#  needed starting from 1
</span></span><span style="display:flex;"><span>wrapper.java.classpath.1=lib/wrapper.jar
</span></span><span style="display:flex;"><span>wrapper.java.classpath.2=%REPO_DIR%/com/jetoile/maven/sample/sample-assembler-plugin/1.0-SNAPSHOT/sample-assembler-plugin-1.0-SNAPSHOT.jar
</span></span><span style="display:flex;"><span>wrapper.java.classpath.3=%REPO_DIR%/org/slf4j/slf4j-api/1.6.4/slf4j-api-1.6.4.jar
</span></span><span style="display:flex;"><span>wrapper.java.classpath.4=%REPO_DIR%/ch/qos/logback/logback-classic/1.0.0/logback-classic-1.0.0.jar
</span></span><span style="display:flex;"><span>wrapper.java.classpath.5=%REPO_DIR%/ch/qos/logback/logback-core/1.0.0/logback-core-1.0.0.jar
</span></span></code></pre></div><p>hum&hellip; l&rsquo;explication est là&hellip; il semble qu&rsquo;il manque le répertoire repo où les librairies sont recherchées&hellip;</p>
<p>Un petit coup de :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn appassembler:appassembler:create-repository
</span></span></code></pre></div><p>devrait permettre de créer le fichier repo dans le répertoire <code>target/appassembler</code>, et un petit cp devrait tout remettre dans l&rsquo;ordre&hellip; en fait, non!</p>
<p>Il manque l&rsquo;archetype de notre application dans le répertoire repo&hellip; (d&rsquo;un coté, pour les personnes qui ont suivi, cela était visible dans un des screenshots précédents&hellip;)</p>
<p>Bon, je vous passe les quelques commandes à base de <code>mvn</code> et <code>cp</code> que j&rsquo;ai effectué pour, au final, obtenir :</p>
<p><img src="http://1.bp.blogspot.com/-5JoIX1E06E8/T0ugnyyJ4YI/AAAAAAAAAjI/b66wqmxMFtM/s1600/appassembler07.png" alt="medium"></p>
<h2 id="conclusion">Conclusion</h2>
<p>Ce qui m&rsquo;a intéressé dans ce plugin est qu&rsquo;il s&rsquo;occupe de générer automatiquement les scripts nécessaires au lancement de l&rsquo;application. En effet, il est toujours possible d&rsquo;utiliser le plugin assembly (tel que je l&rsquo;avais décrit <a href="https://blog.jetoile.fr/2010/02/de-l-du-livrable.html">ici</a>), mais cette solution reste assez verbeuse et rébarbative.
Aussi, avoir la possibilité, en n&rsquo;ayant qu&rsquo;à appeler ou qu&rsquo;à associer un goal à une phase du cycle de vie du projet pour générer les scripts est assez tentant.
En outre, le plugin permet également de wrapper l&rsquo;application dans un service via Java Service Wrapper.</p>
<p>Par contre, il peut sembler dommage que le &ldquo;livrable&rdquo; (au sens naïf du terme) ainsi produit ne puisse pas être considéré comme un archetype (et être déployé automatiquement sur un repository manager afin qu&rsquo;il puisse être directement utilisable par d&rsquo;éventuels OPS). Cependant, concernant ce point, vu que l&rsquo;on s&rsquo;appuie alors sur un plugin maven (dont la version est, bien sûr, maîtrisée), l&rsquo;utilisateur est garanti d&rsquo;avoir un script fonctionnel et reproductible.</p>
<p>Concernant la partie <strong>Java Service Wrapper</strong>, il semble, cependant, qu&rsquo;il faille &ldquo;retoucher&rdquo; un peu ce qui est généré puisqu&rsquo;il manque le répertoire repo (utilisé par le fichier <code>wrapper.conf</code> (chargé par Java Service Wrapper)) nécessaire au chargement du classpath à l&rsquo;exécution du service.</p>
<p>Autre point un peu dommage est que les droits d&rsquo;exécution ne soient pas directement positionnés sur les scripts .sh.</p>
<h1 id="tomcat-7-maven-plugin">Tomcat 7 Maven Plugin</h1>
<h2 id="description-1">Description</h2>
<p>Le plugin Tomcat7 Maven Plugin permet (pour ceux qui ne le savent pas encore&hellip; ;-) ) de déployer une application web dans le conteneur de servlets Tomcat 7 via  le goal <code>deploy</code>.</p>
<p>Il permet, en outre, de démarrer directement un Tomcat de manière <em>embedded</em> à Maven (un peu comme le plugin jetty) via le goal <code>run</code>.</p>
<p>Cependant, ce n&rsquo;est pas pour ces fonctionnalités que je tenais à parler de ce plugin.</p>
<p>En effet, le plugin Tomcat7 dispose d&rsquo;une fonctionnalité &ldquo;amusante&rdquo;, à savoir la possibilité de générer un jar exécutable embarquant directement un Tomcat 7.</p>
<p>En outre, de manière &ldquo;un peu&rdquo; transverse à ce plugin, un <a href="http://tomcat.apache.org/maven-plugin-2.0-beta-1/archetype.html">archetype</a> existe également. Il permet de <em>settuper</em> un projet exposant un service REST via Apache CXF et qui dispose de tests d&rsquo;intégration via Selenium.</p>
<h2 id="cas-dutilisation-1">Cas d&rsquo;utilisation</h2>
<p>Tomcat7 Maven Plugin dispose des <a href="http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/tomcat7-maven-plugin/plugin-info.html">goals</a> suivants (que je décrirai pas&hellip;) :</p>
<ul>
<li><code>tomcat7:deploy</code></li>
<li><code>tomcat7:deploy-only</code></li>
<li><code>tomcat7:exec-war</code></li>
<li><code>tomcat7:exec-war-only</code></li>
<li><code>tomcat7:run</code></li>
<li><code>tomcat7:run-war</code></li>
<li><code>tomcat7:run-war-only</code></li>
<li><code>tomcat7:shutdown</code></li>
</ul>
<p>Concernant l&rsquo;archetype, il est très bien décrit à la page suivante :
<a href="http://tomcat.apache.org/maven-plugin-2.0-beta-1/archetype.html">http://tomcat.apache.org/maven-plugin-2.0-beta-1/archetype.html</a></p>
<h2 id="exemple-1">Exemple</h2>
<h3 id="maven-tomcat-7-plugin">Maven Tomcat 7 Plugin</h3>
<p>Comme je l&rsquo;ai dit précédemment, je ne reviendrai pas sur l&rsquo;utilisation des goals <code>run</code> et <code>deploy</code> mais me focaliserai plutôt sur le goal <code>exec-war</code>.</p>
<p>Pour montrer comment peut être utilisé ce plugin, je vais prendre un projet simple (accessible sur mon <a href="http://github.com/jetoile/sample-tomcat-plugin">github</a>) qui ne contient qu&rsquo;un simple Servlet <code>FooServlet</code>.</p>
<p><img src="http://2.bp.blogspot.com/-ai5ZyP1YbgY/T0u6selcDwI/AAAAAAAAAjQ/Uq8UY04YtRw/s1600/tomcat01.png" alt="center"></p>
<p>où on a :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.jetoile.maven.tomcat.sample<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.servlet.ServletException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.servlet.http.HttpServlet<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.servlet.http.HttpServletRequest<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.servlet.http.HttpServletResponse<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.IOException<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.Writer<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FooServlet</span> <span style="color:#66d9ef">extends</span> HttpServlet <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">doGet</span><span style="color:#f92672">(</span>HttpServletRequest req<span style="color:#f92672">,</span> HttpServletResponse resp<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> ServletException<span style="color:#f92672">,</span> IOException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        </span>Writer out <span style="color:#f92672">=</span> resp<span style="color:#f92672">.</span><span style="color:#a6e22e">getWriter</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        </span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">append</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GET FooServlet successfully called...&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        </span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">flush</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">        </span>out<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">    </span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>pour le <code>web.xml</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;web-app</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://java.sun.com/xml/ns/javaee&#34;</span> <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   </span> <span style="color:#960050;background-color:#1e0010"> </span> <span style="color:#960050;background-color:#1e0010"> </span> <span style="color:#960050;background-color:#1e0010"> </span><span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   </span> <span style="color:#960050;background-color:#1e0010"> </span> <span style="color:#960050;background-color:#1e0010"> </span> <span style="color:#960050;background-color:#1e0010"> </span><span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;3.0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;servlet&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-name&gt;</span>FooServlet<span style="color:#f92672">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-class&gt;</span>com.jetoile.maven.tomcat.sample.FooServlet<span style="color:#f92672">&lt;/servlet-class&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/servlet&gt;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-name&gt;</span>FooServlet<span style="color:#f92672">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;url-pattern&gt;</span>/*<span style="color:#f92672">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/web-app&gt;</span>
</span></span></code></pre></div><p>Le <code>pom.xml</code> qui est utilisé est le suivant :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">         </span><span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">         </span><span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>com.jetoile.maven.tomcat.sample<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>sample-tomcat-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;packaging&gt;</span>war<span style="color:#f92672">&lt;/packaging&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span style="color:#f92672">&lt;/project.build.sourceEncoding&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;projectBaseUri&gt;</span>${project.baseUri}<span style="color:#f92672">&lt;/projectBaseUri&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;java.version&gt;</span>1.6<span style="color:#f92672">&lt;/java.version&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;servlet-api.version&gt;</span>3.0-alpha-1<span style="color:#f92672">&lt;/servlet-api.version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/properties&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>javax.servlet<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>servlet-api<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>${servlet-api.version}<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;scope&gt;</span>provided<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;plugins&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>maven-compiler-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>2.3.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;source&gt;</span>${java.version}<span style="color:#f92672">&lt;/source&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;target&gt;</span>${java.version}<span style="color:#f92672">&lt;/target&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.tomcat.maven<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;version&gt;</span>2.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;executions&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;id&gt;</span>tomcat-war-exec<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;goal&gt;</span>exec-war<span style="color:#f92672">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;phase&gt;</span>package<span style="color:#f92672">&lt;/phase&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;warRunDependencies&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;warRunDependency&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;groupId&gt;</span>com.jetoile.maven.tomcat.sample<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;artifactId&gt;</span>sample-tomcat-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;version&gt;</span>${project.version}<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#f92672">&lt;type&gt;</span>war<span style="color:#f92672">&lt;/type&gt;</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#f92672">&lt;/warRunDependency&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">&lt;/warRunDependencies&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/executions&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/plugins&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/build&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/project&gt;</span>
</span></span></code></pre></div><p>On constate que le goal <code>exec-war</code> est associé à la phase <code>package</code>.</p>
<p>Ainsi, en exécutant la commande suivante :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn package
</span></span></code></pre></div><p>on obtient :
<img src="http://1.bp.blogspot.com/-2AcPO28rAXU/T0u7_kOTMYI/AAAAAAAAAjY/TTEYG1XHSUg/s1600/tomcat02.png" alt="center"></p>
<p>Ainsi, avec la commande suivante :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd target
</span></span><span style="display:flex;"><span>java -jar sample-tomcat-plugin-1.0-SNAPSHOT-war-exec.jar
</span></span></code></pre></div><p>il devient alors possible via notre navigateur préféré (à l&rsquo;url suivante : http://localhost:8080/sample-tomcat-plugin/) d&rsquo;obtenir la page suivante :
<img src="http://2.bp.blogspot.com/-iHTkHAqCDRQ/T0u82VVpcHI/AAAAAAAAAjg/B1DIln_qwbk/s1600/tomcat03.png" alt="center"></p>
<h3 id="maven-tomcat-7-archetype">Maven Tomcat 7 Archetype</h3>
<p>Ce petit paragraphe a juste pour objectif de montrer ce que génère l&rsquo;archetype Tomcat7.
Aussi, à la commande :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn archetype:generate <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>   -DarchetypeGroupId<span style="color:#f92672">=</span>org.apache.tomcat.maven <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>   -DarchetypeArtifactId<span style="color:#f92672">=</span>tomcat-maven-archetype <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>   -DarchetypeVersion<span style="color:#f92672">=</span>2.0-SNAPSHOT <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>   -DarchetypeRepository<span style="color:#f92672">=</span>https://repository.apache.org/content/repositories/snapshots/
</span></span></code></pre></div><p>on obtient le résultat suivant :
<img src="http://3.bp.blogspot.com/-fOfKG8OeGRk/T0yaZtjtEGI/AAAAAAAAAjo/CAVLKEsD7lw/s1600/tomcat06.png" alt="center"></p>
<p>Un rapide coup d&rsquo;oeil permet de se rendre compte que :</p>
<ul>
<li>le <code>module basic-api</code> contient les interfaces pour le webservice REST</li>
<li>le <code>module basic-api-impl</code> contient l&rsquo;implémentation des webservices REST</li>
<li>le <code>module basic-webapp</code> contient l&rsquo;application web</li>
<li>le <code>module basic-webapp-exec</code> permet de générer un jar exécutable embarquant l&rsquo;application web ainsi que le nécessaire de tomcat pour le démarrer en standalone</li>
<li>le <code>module basic-webapp-it</code> permet de démarrer des tests Selenium sur l&rsquo;application web démarrer au sein d&rsquo;un Tomcat7</li>
</ul>
<p>Pour tester, rien de plus simple, il suffit de lancer la commande suivante :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn install -Pchrome
</span></span></code></pre></div><div>
<iframe allowfullscreen="" frameborder="0" height="315" src="http://www.youtube.com/embed/M3b6OPj6mGo" width="560"></iframe></div>
<h2 id="conclusion-1">Conclusion</h2>
<p>Ce qui m&rsquo;a plu sur le plugin Apache Tomcat 7 (en plus, bien sûr de la possibilité de lancer l&rsquo;application web de manière embedded à Maven et de pouvoir déployer la webapp sur un Tomcat existant) est la possibilité de créer un jar exécutable.</p>
<p>C&rsquo;est vrai que je n&rsquo;ai toujours pas trouvé d&rsquo;utilité pour cela mais la performance méritait d&rsquo;être applaudit.</p>
<p>Concernant l&rsquo;archetype Apache Tomcat 7, cela fournit en 1 ligne de commande un excellent template de projet qui dispose de tout.</p>
<h1 id="conclusion-2">Conclusion</h1>
<p>Comme vous avez pu vous en rendre compte, il n&rsquo;y a rien de révolutionnaire dans cet article mais je tenais à mettre en avant ces 2 plugins qui, soit on des fonctionnalités utiles dans le cadre d&rsquo;un projet, soit ont quelques features intéressantes.</p>
<h1 id="pour-aller-plus-loin">Pour aller plus loin&hellip;</h1>
<ul>
<li>Site officiel de l&rsquo;archetype Maven Tomcat7 : <a href="http://tomcat.apache.org/maven-plugin-2.0-beta-1/archetype.html">http://tomcat.apache.org/maven-plugin-2.0-beta-1/archetype.html</a></li>
<li>Site officiel du plugin Maven Tomcat7 : <a href="http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/tomcat7-maven-plugin/">http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/tomcat7-maven-plugin/</a></li>
<li>Site officiel du plugin Maven AppAssembler : <a href="http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/">http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/</a></li>
<li>Blog d&rsquo;Olivier Lamy : <a href="http://olamy.blogspot.com/">http://olamy.blogspot.com/</a></li>
</ul>

  
  <h4><i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Share!</h4>
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Tweet"><i class="fab fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Share on Google+"><i class="fab fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Pin it"><i class="fab fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.jetoile.fr%2f2012%2f02%2fpetit-focus-sur-2-plugins-maven.html" target="_blank" title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://blog.jetoile.fr/2011/12/resign-patterns-les-nouveaux-patterns.html"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://blog.jetoile.fr/2011/12/resign-patterns-les-nouveaux-patterns.html">Resign Patterns : les nouveaux patterns</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://blog.jetoile.fr/2012/03/petits-retours-sur-cassandra.html">Petits retours sur Cassandra</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://blog.jetoile.fr/2012/03/petits-retours-sur-cassandra.html"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>


  
  
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'jetoile';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  

</div>

</div>
</div>
<script src="https://blog.jetoile.fr/js/ui.js"></script>
<script src="https://blog.jetoile.fr/js/menus.js"></script>





<script async src="https://www.googletagmanager.com/gtag/js?id=G-375066041"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-375066041', { 'anonymize_ip': false });
}
</script>




<script src="https://blog.jetoile.fr/js/math-code.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  


</body>
</html>

