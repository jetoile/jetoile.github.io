---
layout: post
title: "Ubuntu 11.04, problème de complétion?"
date: 2011-06-11
comments: false
categories:
 - divers
---

<div class='post'>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-PYGo1WbVX3E/TfOOwCue0II/AAAAAAAAAYE/bP0fMBPp99I/s1600/ubuntuLogo.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="134" src="http://2.bp.blogspot.com/-PYGo1WbVX3E/TfOOwCue0II/AAAAAAAAAYE/bP0fMBPp99I/s320/ubuntuLogo.png" width="320" /></a></div><div style="text-align: justify;">Ubuntu 11.04 est sorti depuis le 28 avril 2011. Je ne reviendrai pas ni sur son ergonomie ni sur ses ajouts puisque cela a déjà été débattu sur de nombreux sites/blogs. Cependant, depuis la mise à jour, un point avait tendance à m'agacer.</div><div style="text-align: justify;">En effet,&nbsp;dans un shell bash,&nbsp;sur la complétion de la commande ls (entre autre) avec des répertoires contenant des espaces, il ne m'échappait plus ces derniers. Du coup, obligation d'aller les échapper manuellement mais chose encore plus embêtante était qu'il ne me proposait plus le contenu de mon répertoire.</div><div style="text-align: justify;">Pire, en échappant les espaces et en utilisant la complétion, il me supprimait mon échappement...</div>Cet article fournira donc une rapide solution pour corriger ce problème.<br /><!-- more --><br /><span class="Apple-style-span" style="font-size: x-large;"><b>Symptôme</b></span><br />Pour l'arborescence ci-dessous, j'avais le comportement suivant :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-s9j2IBv_w7M/TfODhMgXhYI/AAAAAAAAAXk/imMqhaAW9LY/s1600/ubuntu02.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-s9j2IBv_w7M/TfODhMgXhYI/AAAAAAAAAXk/imMqhaAW9LY/s1600/ubuntu02.png" /></a></div><br />Utilisation basique de la complétion :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-YSypzYsV_Zk/TfOBzlrIsVI/AAAAAAAAAXg/-T6-n0Hu5pM/s1600/ubuntu01.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="50" src="http://4.bp.blogspot.com/-YSypzYsV_Zk/TfOBzlrIsVI/AAAAAAAAAXg/-T6-n0Hu5pM/s400/ubuntu01.png" width="400" /></a></div><br />Avec échappement de l'espace...<br />Avant :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-YPHW04jHH0s/TfOEEp0gqDI/AAAAAAAAAXo/t8FKxJedORo/s1600/ubuntu03.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="20" src="http://3.bp.blogspot.com/-YPHW04jHH0s/TfOEEp0gqDI/AAAAAAAAAXo/t8FKxJedORo/s320/ubuntu03.png" width="320" /></a></div>Après exécution de la commande Tab :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-MSYG8ZCqVAE/TfOEVNKnNfI/AAAAAAAAAXs/k6heNnlMZhg/s1600/ubuntu04.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="21" src="http://2.bp.blogspot.com/-MSYG8ZCqVAE/TfOEVNKnNfI/AAAAAAAAAXs/k6heNnlMZhg/s400/ubuntu04.png" width="400" /></a></div>Entraînant, bien sûr, une erreur lors de son exécution :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qdZH3XNVpns/TfOFJ5O3xYI/AAAAAAAAAXw/2ueSn_2rZ9s/s1600/ubuntu05.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="58" src="http://1.bp.blogspot.com/-qdZH3XNVpns/TfOFJ5O3xYI/AAAAAAAAAXw/2ueSn_2rZ9s/s400/ubuntu05.png" width="400" /></a></div><h1>Correctif</h1>Du coup, après une ou deux recherche sur mon ami google, je suis tombé sur le <a href="https://bugs.launchpad.net/ubuntu/+source/bash-completion/+bug/769866">bug suivant</a>.<br /><div style="text-align: justify;">En fait, pour résumer, il semble que cela vienne du script de complétion utilisé par bash.</div><div style="text-align: justify;">Aussi pour corriger ce problème, il ne vous reste plus qu'à éditer le fichier <b>/etc/bash_completion</b> avec les bons droits et à modifier sa ligne 1587 pour y remplacer "default" par "filenames".</div><pre class="brush:bash; wrap-lines: false; auto-links: false"># makeinfo and texi2dvi are defined elsewhere.<br />for i in a2ps awk bash bc bison cat colordiff cp csplit \<br />    curl cut date df diff dir du enscript env expand fmt fold gperf gprof \<br />    grep grub head indent irb ld ldd less ln ls m4 md5sum mkdir mkfifo mknod \<br />    mv netstat nl nm objcopy objdump od paste patch pr ptx readelf rm rmdir \<br />    sed seq sha{,1,224,256,384,512}sum shar sort split strip tac tail tee \<br />    texindex touch tr uname unexpand uniq units vdir wc wget who; do<br />    have $i &amp;&amp; complete -F _longopt -o filenames $i<br />done<br />unset i<br /></pre><div style="text-align: justify;">Après un petit coup de rechargement du bashrc (qui charge le bash_completion), vous aurez alors résolu votre problème ;-)</div>Rechargement du ~/.bashrc :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_e-p2C3ZNPs/TfOJc6I-LoI/AAAAAAAAAX8/Um_QhF9V_18/s1600/ubuntu09.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-_e-p2C3ZNPs/TfOJc6I-LoI/AAAAAAAAAX8/Um_QhF9V_18/s1600/ubuntu09.png" /></a></div><br /><br />Utilisation basique de la complétion et exécution :<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-2wMokee8xhI/TfOJhXsTgiI/AAAAAAAAAYA/FK6AiN7vDfo/s1600/ubuntu08.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-2wMokee8xhI/TfOJhXsTgiI/AAAAAAAAAYA/FK6AiN7vDfo/s1600/ubuntu08.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Utilisation de la complétion après complétion du répertoire :</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-fSXGkhwkeuE/TfOH-TUEJeI/AAAAAAAAAX4/6K1qhgEIt6U/s1600/ubuntu07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="42" src="http://3.bp.blogspot.com/-fSXGkhwkeuE/TfOH-TUEJeI/AAAAAAAAAX4/6K1qhgEIt6U/s320/ubuntu07.png" width="320" /></a></div><div style="text-align: justify;">Voilà pour cet article qui, pour une fois, ne parle pas Java mais qui, je l'espère, pourra être utile... ;-)</div></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Devart</div>
<div class='content'>
Mouarf,<br /><br />depuis que je galère avec ce problème.<br /><br />Pourquoi avoir modifié le comportement par défaut aussi !!<br /><br />Merci pour l&#39;article<br /><br />Cordialement,<br />  Guillaume Dievart.</div>
</div>
</div>
