---
layout: post
title: "JMX pour les nuls... - Les différents MBeans et la notion de Notification - Partie 2"
date: 2010-11-03
comments: false
categories:
 - java
 - jmx
---

<div class='post'>
<div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TMdPuTpRY8I/AAAAAAAAALQ/R_w0PiLpvwo/s1600/jmx-cover.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TMdPuTpRY8I/AAAAAAAAALQ/R_w0PiLpvwo/s200/jmx-cover.png" width="171" /></a></div><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html">Mon précédent article</a> portant sur la présentation générale de JMX a permis de poser les bases quant aux concepts fondamentaux. Cette seconde partie ainsi que les suivantes consistent en une descente plus en profondeur dans les entrailles des spécifications en reprenant les différentes notions vues précédemment.&nbsp;</div><div style="text-align: justify;"><br />Ainsi, cette partie traitera des différents MBeans et du concept notification.</div><!-- more --><br /><h1>Table des matières</h1><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html">JMX, qu'est ce que c'est?</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#generalite">Généralités</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#architecture">Architecture JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#instrumentation">Niveau instrumentation</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#agent">Niveau agent</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#distribue">Niveau service distribué</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#composant">Composants JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#mbean">MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#notification">Modèle de notifications</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#metadonnee">Classe de métadonnées de MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#serveur">Serveur de MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#services">Service d'agents</a></li></ul></ul><li>Spécifications</li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html">JMX Instrumentation</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean">MBean</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_standard">MBean Standard</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_dynamic">Dynamic MBean</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#notification">Notification</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_open">Open MBean</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_model">Model MBean</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-agents-jmx-partie.html#agent">Agent JMX</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html">Concepts</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectname">ObjectName</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectinstance">ObjectInstance</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#attribute">Attribute et AttributeList</a></li><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#exception">Les Exceptions</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/11/jmx-pour-les-nuls-le-mbean-server.html">MBean Server</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-chargement-dynamique.html">Chargement dynamique des MBeans</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html">Les services JMX</a></li><ul><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#monitoring">Service Monitoring</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#timer">Service Timer</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#relation">Service Relation</a></li><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-services-jmx.html#securite">Service Sécurité</a></li></ul><li><a href="http://jetoile.blogspot.com/2010/12/jmx-pour-les-nuls-les-connecteurs.html">Les Connecteurs</a></li></ul></ul><a name="mbean"></a> <h1>MBean</h1><div style="text-align: justify;">Un MBean est une classe java concrète qui :</div><ul><li style="text-align: justify;">doit implémenter sa propre interface <i>MBean</i> ou implémenter l’interface <i>DynamicMBean</i>,</li><li style="text-align: justify;">peut implémenter l’interface <i>NotificationBroacaster</i></li></ul><div style="text-align: justify;">Une classe qui implémente sa propre interface de <i>MBean</i> est un MBean Standard. Cette manière de procéder est la plus simple. Dans ce cas, les opérations et attributs accessibles sont déterminés statiquement grâce à l’introspection de l’interface du MBean.</div><div style="text-align: justify;">Pour un Dynamic MBean (et donc une classe implémentant l’interface <i>DynamicMBean</i>), les opérations et les attributs sont exposés de manière indirecte à l’agent JMX qui invoque alors des méthodes pour déterminer le nom et la nature des opérations et attributs.&nbsp;</div><div style="text-align: justify;">Un MBean n’est pas obligatoirement une classe publique Java. Cependant, elle doit implémenter une interface publique (que ce soit ses propres opérations pour un MBean standard ou l’interface <i>DynamicMBean</i> pour un MBean dynamique).&nbsp;</div><div style="text-align: justify;">En outre, le MBean peut avoir plusieurs constructeurs qui doivent être publiques s’il doit être instancié par un agent.</div><a name="mbean_standard"></a> <h2>MBean Standard</h2><div style="text-align: justify;">Comme il a été vu précédemment que, pour être gérable via un agent JMX, un MBean Standard doit explicitement définir son interface de gestion et doit être conforme à certaines règles de nommage qui sont inspirées du modèle des JavaBean.</div><div style="text-align: justify;">Ainsi, l’interface de gestion d’un MBean Standard peut être composée de :</div><ul><li style="text-align: justify;">ses constructeurs : seuls les constructeurs publics sont exposés,</li><li style="text-align: justify;">ses attributs : les propriétés qui sont exposées le sont au travers des getter et setter,</li><li style="text-align: justify;">ses opérations : les méthodes qui sont exposées sont toutes les méthodes qui ne sont pas des getter ou des setter,</li><li style="text-align: justify;">ses notifications.</li></ul><div style="text-align: justify;">En outre, l’interface qui est implémenté par le MBean doit porter le même nom que ce dernier mais avec le suffixe <i>MBean</i> (par exemple, si la classe à gérer se nomme MyClass, alors l’interface devra se nommer MyClassMBean).</div><div style="text-align: justify;">Une classe peut aussi être administrable par son héritage si elle respecte un des modèles suivants :</div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><th align="center">Modèles</th> <th align="center">Commentaires</th></tr><tr><td><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNQHfzV3I/AAAAAAAAALc/YTeLXLYZLSM/s1600/jmx02.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="179" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNQHfzV3I/AAAAAAAAALc/YTeLXLYZLSM/s200/jmx02.png" width="200" /></a></div></td> <td>Les opérations exposées sont a1 et a2.</td></tr><tr><td><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNQQW_w2I/AAAAAAAAALg/shMqH7XIyfk/s1600/jmx03.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="92" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNQQW_w2I/AAAAAAAAALg/shMqH7XIyfk/s200/jmx03.png" width="200" /></a></div></td> <td>Si B étend A sans implémenter sa propre interface, alors B hérite de l’interface de management AMBean et les opérations exposées sont a1 et a2.</td></tr><tr><td><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNQpfTdAI/AAAAAAAAALk/aXy_rHOAVbY/s1600/jmx04.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="92" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNQpfTdAI/AAAAAAAAALk/aXy_rHOAVbY/s200/jmx04.png" width="200" /></a></div><br /></td><td>B hérite de A et implémente sa propre interface de management BMBean. L’opération exposée est b2.</td></tr><tr><td><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCNRII-pTI/AAAAAAAAALo/P97HDUlqIYw/s1600/jmx05.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="90" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCNRII-pTI/AAAAAAAAALo/P97HDUlqIYw/s200/jmx05.png" width="200" /></a></div><br /></td><td>B hérite de A et implémente son interface de management qui hérite de celle de A. Les opérations exposées sont a1, a2 et b2.<br />A noter que si B n’étendait pas A, les opérations exposées seraient similaires.</td></tr><tr><td><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNR6tYsnI/AAAAAAAAALw/2vLb7jJai6s/s1600/jmx07.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="91" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNR6tYsnI/AAAAAAAAALw/2vLb7jJai6s/s200/jmx07.png" width="200" /></a></div><br /></td><td>B implémente son interface de management qui hérite de l’interface AMBean. Les opérations exposées sont a1, a2 et b2.</td></tr></tbody></table><div style="text-align: justify;">Les attributs sont les champs ou les propriétés des MBean implémentés (ou étendus). Ils sont déterminés par leurs noms (la méthode <i>Character.isJavaIdentifierStart</i> (resp. <i>Character.isJavaIdentifierPart</i>) doit renvoyer vrai pour sa première lettre (resp. ses autres lettres)) et par leurs types et sont accédés au travers de leurs accesseurs. Aussi, si un attribut n’a pas d’accesseurs, il ne sera pas visible puisque, pour rappel, ses accesseurs permettent également de déterminer son niveau d’accessibilité (lecture seule, écriture seule ou lecture-écriture). Cependant, il est à noter qu’un attribut ne doit avoir qu’un seul getter et/ou setter et peut être de n’importe quel type Java (cela inclus également les tableaux).  </div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Un attribut doit suivre la règle de nommage suivante :<br /><ul><li>Sa première lettre doit renvoyée vrai à la méthode <i>Character.isJavaIdentifierStart</i></li><li>Ses autres lettres doivent renvoyées vrai à la méthode <i>Character.isJavaIdentifierPart</i></li></ul></td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td> <td>Les attributs et opérations sont case sensitives.<br />En outre, un attribut ne peut avoir qu’un seul getter et/ou setter.<br />Par exemple, les attributs suivants ne sont pas valides :<br /><i>boolean valid ;</i><br /><i> int number ;</i><br /><i> boolean isValid() {return this.valid ;}</i><br /><i> boolean getValid() {return this.valid ;}</i><br /><i>void setNumber(int number) {this.number = number ;}</i><br /><i> void setNumber(String number) {this.number = Integer.valueOf(number) ;}</i></td></tr></tbody></table><div style="text-align: justify;">Les opérations JMX peuvent avoir différentes fonctions (comme effectuer une opération interne sur la ressource managée ou renvoyer une valeur) et sont des méthodes Java qui doivent être spécifiées dans l’interface de management (MBean). Ainsi, toute opération qui ne répond pas au design pattern défini par la définition d’attribut JMX est vue comme une opération.</div><a name="mbean_dynamic"></a> <h2>Dynamic MBean</h2><div style="text-align: justify;"></div><div style="text-align: justify;">Alors que les MBean Standard permettent de gérer des ressources bien définies, les Dynamics MBean offrent une solution plus flexible. En effet, les Dynamics MBean sont des ressources qui sont instrumentés au travers d’une interface prédéfinie qui n’expose les attributs et les opérations qu’à l’exécution. En effet, au lieu d’exposer ses opérations et attributs au travers de méthodes déterminées à l’avance, les Dynamics MBean implémentent une méthode qui retourne tous ses attributs ainsi que la signature de toutes ses méthodes, permettant ainsi de rendre l’exposition dynamique.&nbsp;</div><div style="text-align: justify;">En fait, un MBean qui implémente l’interface <i>DynamicMBean</i> ne fonctionne pas par introspection comme les MBean Standard mais appelle des méthodes qui lui renvoient les attributs et opérations gérables.</div><div style="text-align: justify;">Ainsi, un MBean Dynamic est une classe Java qui implémente directement ou indirectement (ie. par héritage) l’interface publique <i>DynamicMBean</i>.  </div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCUxCaOtDI/AAAAAAAAAL8/xrRlOQfuDAo/s1600/jmx13.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCUxCaOtDI/AAAAAAAAAL8/xrRlOQfuDAo/s1600/jmx13.png" /></a></div></div><div style="text-align: justify;">En fait, cette interface définie les méthodes suivantes :</div><ul><li style="text-align: justify;"><i>getMBeanInfo</i> qui retourne une instance d’un <i>MBeanInfo</i> et qui contient la définition de l’interface de management du MBean, c'est-à-dire la liste des ses attributs associés à leurs types et leurs propriétés (lecture-seule, écriture, lecture-écriture), de ses opérations associées à leurs signatures, la liste des notifications ainsi que la description des constructeurs offerts par le MBean.</li></ul><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNStck85I/AAAAAAAAAL0/FeAhq8knqNM/s1600/jmx08.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCNStck85I/AAAAAAAAAL0/FeAhq8knqNM/s320/jmx08.png" width="320" /></a></div></div><ul><li style="text-align: justify;"><i>getAttribute</i> et <i>getAttributes</i> qui retournent le ou les attributs demandés.</li><li style="text-align: justify;"><i>setAttribute</i> et <i>setAttributes</i> qui permettent de renseigner les attributs.</li><li style="text-align: justify;"><i>invoke</i> qui permet d’invoquer toutes les opérations offertes par le MBean.</li></ul><div style="text-align: justify;">En outre, tout comme pour les MBean Standard, les Dynamic MBean peuvent hériter leur instrumentation d’une superclasse, mais il est à noter que l’interface de management ne peut être composée d’un arbre d’héritage puisque l’interface de management est fournie par le <i>MBeanInfo</i>.&nbsp;</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCVlbEX3AI/AAAAAAAAAMA/_H914xn8sP8/s1600/jmx15_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="215" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCVlbEX3AI/AAAAAAAAAMA/_H914xn8sP8/s320/jmx15_1.png" width="320" /></a></div></div><div style="text-align: justify;">Ainsi, dans l’exemple suivant, si la classe D étend la classe C sans redéfinir la méthode <i>getMBeanInfo</i>, alors D aura la même interface de management que C. Cependant, D pourra, en redéfinissant les accesseurs redéfinir l’implémentation de ses attributs.</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNR6tYsnI/AAAAAAAAALw/2vLb7jJai6s/s1600/jmx07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="146" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCNR6tYsnI/AAAAAAAAALw/2vLb7jJai6s/s320/jmx07.png" width="320" /></a></div></div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Le serveur MBean ne teste ni ne valide la description du Dynamic MBean : c’est au développeur de vérifier si l’interface de management est conforme à l’implémentation interne.</td></tr></tbody></table><div style="text-align: justify;"></div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>De par sa nature, un Dynamic MBean est susceptible d’évoluer à l’exécution de l’application. Cependant, seules des applications de management  propriétaires peuvent prendre en compte ces changements puisqu’il est nécessaire de les notifier en cas de changements.</td></tr></tbody></table><div style="text-align: justify;"></div><a name="notification"></a> <h1>Notification</h1><div style="text-align: justify;">Les interfaces de gestion des MBean permettent à un agent de récupérer ou de modifier la valeur des attributs des ressources ainsi que d’invoquer des opérations sur ces dernières. Cependant, JMX permet également de notifier les applications de gestion en cas de changement d’état du système (et plus particulièrement des ressources).</div><div style="text-align: justify;">Ainsi, JMX propose un modèle pour émettre des événements (appelés Notification) fonctionnant sur le principe d’écouteurs : les applications de managements et les autres objets enregistrés peuvent s’enregistrer comme des écouteurs (<i>NotificationListener</i>) du MBean émetteur de notifications (<i>Notification</i>). Il est cependant à noter qu’il ne leur est possible de ne s’enregistrer qu’une seule fois auprès de l’émetteur.&nbsp;</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCYqpaFn1I/AAAAAAAAAME/hy9yqTxYLjU/s1600/jmx11_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="79" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCYqpaFn1I/AAAAAAAAAME/hy9yqTxYLjU/s200/jmx11_1.png" width="200" /></a></div></div><div style="text-align: justify;">Les notifications sont encapsulées dans une implémentation de l’interface <i>Notification</i> qui est composée :</div><ul><li style="text-align: justify;">du type de notification (de type <i>String</i>) qui est formatée à la façon des propriétés java (ie. une chaine de caractère utilisant des points. Par exemple : <i>vendorName.resourceA.eventA1</i>). Il est à noter que les types de notification préfixés par <i>JMX</i>. sont réservées aux notifications émises par l’infrastructure JMX (par exemple, &nbsp;<i>JMX.mbean.registered</i>).</li><li style="text-align: justify;">d’un numéro de séquence qui permet d’identifier une instance particulière de notification dans un contexte de broadcast.</li><li style="text-align: justify;">du timestamp qui permet de savoir quand la notification a été générée.</li><li style="text-align: justify;">du message émis (de type <i>String</i>) qui peut permettre d’expliciter la notification à l’utilisateur.</li><li style="text-align: justify;">d’information utilisateur (de type <i>Object</i>) qui peut contenir d’autres types d’information.&nbsp;</li></ul><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCZPDKjyTI/AAAAAAAAAMM/4AH_JVk_0Rk/s1600/jmx14_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCZPDKjyTI/AAAAAAAAAMM/4AH_JVk_0Rk/s200/jmx14_1.png" width="190" /></a></div></div><div style="text-align: justify;">Du coté de l’émetteur, il doit implémenter soit l’interface <i>NotificationBroadcaster</i>, soit l’interface <i>NotificationEmitter</i>.</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCZnN_WiiI/AAAAAAAAAMQ/U3qrTB-431c/s1600/jmx12_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="114" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCZnN_WiiI/AAAAAAAAAMQ/U3qrTB-431c/s320/jmx12_1.png" width="320" /></a></div></div><div style="text-align: justify;">En outre, il est également possible de filtrer les notifications reçues en implémentant l’interface <i>NotificationFilter</i>.</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCZ3MbN7WI/AAAAAAAAAMU/kM4ERUGeCBg/s1600/jmx10_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="78" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCZ3MbN7WI/AAAAAAAAAMU/kM4ERUGeCBg/s200/jmx10_1.png" width="200" /></a></div></div><a name="mbean_open"></a> <h1>Open MBean</h1><div style="text-align: justify;">Les Open MBean sont un-sous type des Dynamic MBean. En fait, il s’agit de Dynamic MBean mais dont le type des attributs et des signatures des opérations a été normalisé afin de permettre une meilleure interopérabilité entre le MBean et l’interface de management. Ainsi, l’application de management et les Open MBean peuvent partager et utiliser les données de management (attribut) et invoquer les opérations sans nécessiter une recompilation, un ré-assemblement ou un linkage dynamique, opérations qui nécessiteraient que l’application de management ait accès aux classes Java de l’agent si les types n’étaient pas normalisés.&nbsp;</div><div style="text-align: justify;">Cependant, les Open MBean ne sont que des Dynamic MBean, c'est-à-dire que c’est à la charge du développeur de vérifier qu’ils n’utilisent que les types définis supportés par les Open MBean.&nbsp;</div><div style="text-align: justify;">Aussi, la méthode <i>getMBeanInfo()</i> doit retourner une instance d’un <i>OpenMBeanInfoSupport</i> plutôt qu’une instance d’un <i>MBeanInfo</i> (pour rappel, un Dynamic MBean doit implémenter l’interface <i>DynamicMBean</i> qui possède la méthode <i>getMBeanInfo() </i>et qui renvoie un objet de type <i>MBeanInfo</i>).&nbsp;</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCaO8HRaJI/AAAAAAAAAMY/dAkSqsvCRbQ/s1600/jmx17_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="247" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCaO8HRaJI/AAAAAAAAAMY/dAkSqsvCRbQ/s400/jmx17_1.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"></div></div><div style="text-align: justify;">Les types supportés par les Open MBean sont :</div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><th align="center" colspan="2">Type de données supportées par les Open MBean</th></tr><tr><td>java.lang.Boolean</td><td>java.lang.Float</td></tr><tr><td>java.lang.Byte</td><td>java.lang.Integer</td></tr><tr><td>java.lang.Character</td><td>java.lang.Long</td></tr><tr><td>java.lang.Double</td><td>java.lang.Short</td></tr><tr><td>boolean[]</td><td>float[]</td></tr><tr><td>byte []</td><td>int[]</td></tr><tr><td>char[]</td><td>long[]</td></tr><tr><td>double[]</td><td>short[]</td></tr><tr><td>java.lang.String</td><td>java.lang.Void (retour d’opérations seulement)</td></tr><tr><td>java.math.BigDecimal</td><td>java.math.BigInteger</td></tr><tr><td>java.util.Date</td><td>javax.management.ObjectName</td></tr><tr><td>javax.management .openmbean.CompositeData (interface)</td><td>javax.management.openmbean.TabularData (interface)</td></tr></tbody></table><div style="text-align: justify;"></div><div style="text-align: justify;">Les types <i>CompositeData</i> et <i>TabularData</i> sont utilisés pour agréger les données basiques (tels que les <i>String</i> ou les tableaux de <i>int</i>) et fournissent un mécanisme pour fournir des structures de données complexes. Bien que ces types soient des types simples (au sens JMX du terme), elles peuvent contenir d’autres <i>CompositeData</i> ou <i>TabularData</i>.</div><div style="text-align: justify;">En fait, une implémentation d’un <i>CompositeData</i> est équivalente à une <i>Map</i>, alors qu’une instance d’un <i>TabularData</i> est équivalente à un tableau de <i>CompositeData</i>.</div><div style="text-align: justify;">Il est à noter qu’un <i>CompositeData</i> est une structure immuable. Ainsi dès qu’il est instancié, il n’est pas possible de le modifier. Le <i>TabularData</i> peut, quant à lui, être modifié.</div><div style="text-align: justify;"></div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCb7nMHwgI/AAAAAAAAAMc/2_IcnEmbYAU/s1600/jmx17_bis.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="310" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCb7nMHwgI/AAAAAAAAAMc/2_IcnEmbYAU/s320/jmx17_bis.png" width="320" /></a></div></div><div style="text-align: justify;">JMX fournit une implémentation de ces interfaces qu’il est possible d’utiliser. Pour le <i>CompositeData</i>, il s’agit de <i>CompositeDataSupport</i> et, pour le <i>TabularData</i>, <i>TabularDataSupport</i> (classe qui définie une structure de tableau contenant des <i>CompositeData</i> qui doivent avoir le même <i>CompositeType</i>).</div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Les classes <i>GCInfo</i>, <i>MemoryNotifInfoCompositeData</i>, <i>MemoryUsageCompositeData</i>, <i>MonitorInfoCompositeData</i>, <i>StackTraceElementCompositeData</i>, <i>ThreadInfoCompositeData</i> et <i>VMOptionCompositeData</i> implémentent également l’interface <i>CompositeDataSupport</i>.</td></tr></tbody></table><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCcUpilkdI/AAAAAAAAAMg/GnDbK9JVRqo/s1600/jmx18_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="303" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCcUpilkdI/AAAAAAAAAMg/GnDbK9JVRqo/s320/jmx18_1.png" width="320" /></a></div></div><div style="text-align: justify;">Cependant, le fait d’utiliser des types de données complexes nécessite que l’Open MBean doit décrire la structure des données. Pour cela, les Open MBean proposent une classe abstraite <i>OpenType</i> qui décrit aussi bien ses types basiques que ses types complexes. Cette classe abstraite est donc étendue par des classes qui décrivent chacun de ses types cités ci-dessus en spécifiant le nom du type, sa description ainsi que la classe qui la spécifie. Cela permet, pour les types complexes, de fournir une description et un nom de chaque élément qui le compose.</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCccuJTwzI/AAAAAAAAAMk/tAsptdhxVj8/s1600/jmx20.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="301" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCccuJTwzI/AAAAAAAAAMk/tAsptdhxVj8/s320/jmx20.png" width="320" /></a></div></div><div style="text-align: justify;">De plus, comme indiqué précédemment, un Open MBean étant un Dynamic MBean, il doit s’auto décrire via l’interface <i>MBeanInfo</i>. Pour cela, JMX propose, par défaut, des sous-classes des classes permettant de décrire un Dynamic MBean (<i>MBeanInfo</i>, <i>MBeanAttributeInfo</i>, <i>MBeanOperationInfo</i>, <i>MBeanParameterInfo</i>, <i>MBeanConstructorInfo</i>) et dont le nom est préfixé par <i>Open</i> et postfixé par <i>Support</i> (<i>OpenMBeanInfoSupport</i>, <i>OpenMBeanAttributeInfoSupport</i>, <i>OpenMBeanOperationInfoSupport</i>, <i>OpenMBeanParameterInfoSupport</i>, <i>OpenMBeanConstructorInfoSupport</i>).</div><div style="text-align: justify;">Les notifications sont, quant à elle, standard.</div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCczbc-JCI/AAAAAAAAAMo/ivfzCGCGR0A/s1600/jmx21_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="223" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCczbc-JCI/AAAAAAAAAMo/ivfzCGCGR0A/s320/jmx21_1.png" width="320" /></a></div></div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCdCn-DxlI/AAAAAAAAAMs/61pQhkzTh4c/s1600/jmx22_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCdCn-DxlI/AAAAAAAAAMs/61pQhkzTh4c/s320/jmx22_1.png" width="195" /></a></div></div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCdZywnsaI/AAAAAAAAAMw/pWaoBFBfLR4/s1600/jmx23_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="307" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCdZywnsaI/AAAAAAAAAMw/pWaoBFBfLR4/s320/jmx23_1.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCdaX_4lPI/AAAAAAAAAM0/D_ck5n0AsvE/s1600/jmx25_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TNCdaX_4lPI/AAAAAAAAAM0/D_ck5n0AsvE/s320/jmx25_1.png" width="236" /></a></div></div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCdtEsWmrI/AAAAAAAAAM4/gE6SvL-vWVI/s1600/jmx26_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCdtEsWmrI/AAAAAAAAAM4/gE6SvL-vWVI/s320/jmx26_1.png" width="320" /></a></div></div></div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Pour développer un Open MBean, il faut :<br /><ul><li>Que la ressource à manager implémente l’interface <i>DynamicMBean</i></li><li>Que tous les attributs et les signatures des méthodes soient des types supportés par les OpenMBean</li><li>Que l’implémentation de la méthode <i>getMBeanInfo</i> retourne une instance de l’interface <i>OpenMBeanInfo</i> (par exemple, une instance d’un <i>OpenMBeanInfoSupport</i>) qui doit retourner des objets de type <i>OpenMBeanXXXInfo</i></li><li>Que les méthodes suivantes retournent des objets valides et non null :  <ul><li><i>OpenMBeanInfo.getDescription</i></li><li><i>OpenMBeanOperationInfo.getDescription</i></li><li><i>OpenMBeanConstructorInfo.getDescription</i></li><li><i>OpenMBeanParameterInfo.getDescription</i></li><li><i>OpenMBeanAttributeInfo.getDescription</i></li><li><i>MBeanNotificationInfo.getDescription</i></li></ul></li><li>Que la méthode <i>OpenMBeanOperationInfo.getImpact</i> retourne une des constantes suivantes :  <ul><li><i>ACTION</i>,</li><li><i>INFO</i>,</li><li><i>ACTION_INFO</i>.</li></ul></li></ul></td></tr></tbody></table><a name="mbean_model"></a> <h1>Model MBean</h1><div style="text-align: justify;">Un Model MBean est un MBean générique configurable ayant pour objectif de fournir un patron de MBean pouvant être utilisé simplement par n’importe quelles ressources. Il s’agit, en fait, d’un MBean Dynamic particulier dont l’interface définie une structure qui, lorsqu’elle est implémentée, fournie un MBean avec un comportement par défaut. Ces Model MBean devant être supportés par les agents JMX, ils peuvent être utilisés par n’importe quels applications, ressources et services pour créer un objet gérable à l’exécution : les utilisateurs n’ont qu'a instancier un Model MBean, configurer son comportement par défaut et l’enregistrer au sein de l’agent JMX.</div><div style="text-align: justify;">En fait un Model MBean est constitué d’un ensemble d’interfaces et de classes concrètes fournit par l’agent JMX (qui doit fournir une implémentation de la classe <i>RequiredModelMBean</i> et qui a pour objectif de fournir un comportement par défaut).</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCd8pEaVUI/AAAAAAAAAM8/zp_uL_-y7p8/s1600/jmx29.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCd8pEaVUI/AAAAAAAAAM8/zp_uL_-y7p8/s320/jmx29.png" width="250" /></a></div></div><div style="text-align: justify;">Un MBean Server est donc un repository et factory de Model MBean qui peuvent être obtenus au travers de l’agent JMX afin de rendre une ressource gérable : le développeur n’a pas besoin de fournir une implémentation de cette classe mais juste la configurer à l’exécution afin d’exposer l’interface d’administration et de supervision nécessaire à la ressource.</div><div style="text-align: justify;">La ressource à administrer et à superviser ajoute ses attributs, ses opérations et ses notifications à l’objet basique Model MBean en s’interfaçant avec l’agent JMX et à son ou ses Model MBean.</div><div style="text-align: justify;">Comme précisé précédemment, un Model MBean est un Dynamic MBean et doit donc implémenter l’interface <i>DynamicMBean</i>.</div><div style="text-align: justify;">Il est également à noter que l’implémentation du <i>RequiredModelMBean</i> est dépendante de l’environnement et plus précisément de la JVM : elle peut fournir des mécanismes de persistance, de transaction, de cache, de scalabilité ou de fonctionnement distant en fonction des besoins. Ainsi, le développeur n’a pas à se soucier de problématiques comme celles de persistance en se fiant à l’implémentation de la JVM sur lequel fonctionne son application (par exemple, un environnement J2ME n’a pas besoin d’offrir des propriétés de persistance ou d’accès distant) : il peut le déléguer au Model MBean exposé.</div><div style="text-align: justify;">Une implémentation d’un Model MBean doit implémenter l’interface <i>ModelMBean</i> qui étend les interfaces <i>DynamicMBean</i>, <i>PersistentMBean</i> et <i>ModelMBeanNotificationBroadcaster</i>.&nbsp;</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCeTxNgCPI/AAAAAAAAANA/P68PBgsxiEY/s1600/jmx27_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="127" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCeTxNgCPI/AAAAAAAAANA/P68PBgsxiEY/s320/jmx27_1.png" width="320" /></a></div></div><div style="text-align: justify;">En outre, le Model MBean doit exposer ses méta-données dans un objet de type <i>ModelMBeanInfoSupport</i> qui étend la classe <i>MBeanInfo</i> et qui implémente l’interface <i>ModelMBeanInfo</i>.</div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCekBf1QzI/AAAAAAAAANE/uRwZx4k-7CU/s1600/jmx28_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="204" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCekBf1QzI/AAAAAAAAANE/uRwZx4k-7CU/s320/jmx28_1.png" width="320" /></a></div></div><div style="text-align: justify;">De plus, une instance d’un Model MBean peut émettre des notifications lors de changements de la valeur de ses attributs et possède un constructeur par défaut et un constructeur qui prend en paramètre une instance d’un <i>ModelMBeanInfo</i>. Il est à noter que chaque attribut, constructeur, opération et notification peut fournir sa description. Ces descriptions peuvent être de différentes natures comme la politique de connexion, la politique de notifications, …&nbsp;</div><div style="text-align: justify;">Enfin, les descriptions d’un Model MBean fournissent un mapping entre les attributs et les opérations de l’interface de gestion et les méthodes utilisées par la ressource à gérer (méthodes set, get et invoke). Il est à noter que ces ressources peuvent être indifféremment sur une autre JVM si le Model MBean a été configuré.&nbsp;</div><div><div><div style="text-align: justify;">Concrètement, une ressource managée donc doit utiliser l’interface <i>ModelMBeanInfo</i> pour exposer son interface d’administration et de supervision. A l’initialisation, la ressource managée créée ou trouve via le MBean Server une ou des instances d’un <i>ModelMBean</i> qui peuvent alors être configurées avec son interface de management (via une implémentation de l’interface <i>ModelMBeanInfo</i>).</div></div><div><div style="text-align: justify;">De la même manière, l’application de management (l’application cliente des ressources à administrer et superviser) via le serveur MBean peut accéder aux descriptions, aux opérations et aux notifications du ModelMBean afin de pouvoir les exposer à l’administrateur en lui fournissant le maximum d’information.</div></div><div><div style="text-align: justify;">Afin de permettre au Model MBean de fournir la description de ses différentes opérations, notifications et attributs, JMX propose, par défaut, des sous-classes des classes permettant de décrire un <i>ModelMBean</i> : <i>ModelMBeanInfoSupport</i>, <i>ModelMBeanAttributeInfo</i>, <i>ModelMBeanOperationInfo</i>, <i>ModelMBeanNotificationInfo</i>, <i>ModelMBeanConstructorInfo</i>).</div></div><div><div style="text-align: justify;">Ces classes implémentent l’interface <i>DescriptorAccess</i> qui permet de remplacer l’interface <i>Descriptor</i> pour chaque attribut, constructeur, opération et notification dans l’interface de management. La description est alors accédée au travers des méta-données de chaque composant.</div></div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCfZU2SohI/AAAAAAAAANI/OXAP8J6klxE/s1600/jmx32.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="294" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCfZU2SohI/AAAAAAAAANI/OXAP8J6klxE/s320/jmx32.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCfieyUY9I/AAAAAAAAANM/r9J5xW6yD1Y/s1600/jmx35.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCfieyUY9I/AAAAAAAAANM/r9J5xW6yD1Y/s320/jmx35.png" width="243" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCfphXk6qI/AAAAAAAAANQ/HyNPv6cxZy8/s1600/jmx34.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCfphXk6qI/AAAAAAAAANQ/HyNPv6cxZy8/s320/jmx34.png" width="276" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCfzx5EXdI/AAAAAAAAANU/sypPZS0mmy8/s1600/jmx36.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TNCfzx5EXdI/AAAAAAAAANU/sypPZS0mmy8/s320/jmx36.png" width="264" /></a></div></div></div><div><div style="text-align: justify;">L’interface <i>NotificationBroadcaster</i>, qui permet lorsqu’elle est implémentée par une MBean d’émettre des notifications génériques ou spécifiques et/ou lorsqu’un changement de valeur d’un attribut se produit à des MBean déclarés comme écouteur, est implémentée pour les Model MBean par l’interface <i>ModelMBeanNotificationBroadcaster</i>.</div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCgZrU3ClI/AAAAAAAAANY/7OggAyAVTas/s1600/jmx36_bis.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="175" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCgZrU3ClI/AAAAAAAAANY/7OggAyAVTas/s320/jmx36_bis.png" width="320" /></a></div></div></div><div><div><div style="text-align: justify;">L’interface <i>Descriptor</i> fournit les descriptions des opérations, attributs et notifications du Model MBean qui ne sont pas accédées directement mais au travers de l’interface <i>DescriptorAccess</i> qui définit comment récupérer et positionner la valeur des différents champs qui constituent la description.</div></div><div><div style="text-align: justify;">Par défaut, JMX fournit deux implémentations de l’interface <i>Descriptor</i> : <i>ImmutableDescriptor</i> et <i>DescriptorSupport</i>.</div></div></div><div><div style="text-align: justify;"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCgiOsFsOI/AAAAAAAAANc/JzGI0sNlKj8/s1600/jmx37.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TNCgiOsFsOI/AAAAAAAAANc/JzGI0sNlKj8/s320/jmx37.png" width="103" /></a></div></div></div><div><div><div style="text-align: justify;">En fait, l’interface <i>ModelMBeanInfo</i> publie des méta-données sur les attributs, les opérations et les notifications déclarés dans l’interface d’administration et de supervision. Les descripteurs du Model MBean fournissent, quant à eux, le comportement et les règles de ces attributs, opérations et notifications. Un descripteur se présente sous forme d’un ensemble de clé/valeur où la clé est de type <i>String</i> et la valeur est de type <i>Object</i> qui peut être modifié (ajout, modification et suppression des champs) par la ressource managée ou par l’application de gestion. Il est à noter que certains noms sont réservés pour des propriétés prédéfinies telles que la gestion du cache ou de la persistance. Les descripteurs contiennent également le nom des opérations des getter et setter utilisées pour lire et écrire la valeur des attributs.&nbsp;</div></div><div><div style="text-align: justify;">Comme indiqué précédemment, les descripteurs sont des objets qui implémentent l’interface <i>Descriptor</i> et qui sont accessibles au travers des méthodes définies par l’interface <i>DescriptorAccess</i> dont les méthodes doivent être définies par les implémentations concrètes des interfaces <i>ModelMBeanAttributeInfo</i>, <i>ModelMBeanOperationInfo</i>, <i>ModelMBeanConstructorInfo</i> et <i>ModelMBeanNotificationInfo</i> (qui sont accessibles via l’instance de <i>ModelMBeanInfo</i>).</div></div><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Si le descripteur d’un attribut ne possède pas les signatures de ses méthodes, alors l’application ne peut gérer l’attribut : lorsque la méthode <i>setAttribute</i> est invoquée, la valeur est enregistrée dans le descripteur et une notification de type <i>AttributeChangeNotification</i> est émise à destination des écouteurs enregistrés comme intéressés par cet attribut.<br />Si la méthode <i>getAttribute</i> est invoquée, la valeur est renvoyée par le descripteur mais sa valeur ne peut pas être rafraichie par la ressource managée.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Le Model MBean ne loguera les notifications que si le champ <i>logfile</i> dans le descripteur associé à la notification est renseigné.<br />La journalisation des notifications ne se fera que si l’implémentation du Model MBean ou de l’agent JMX le supporte. Dans le cas contraire, les champs <i>log</i> et <i>logfile</i> seront ignorés.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>La politique de persitance peut être implémentée optionnellement. Cependant, même si elle est géré par le Model MBean, il n’est pas obligé que ce soit ce dernier qui l’implémente et elle peut être offerte par l’agent JMX qui peut proposer en différents niveaux.<br />Lorsqu’aucune politique n’est implémentée, l’objet est transient par défaut. La politique de persistance peut être une implémentation simple offerte en sérialisant dans un fichier les données.<br />Les champs prédéfinis persistLocation et persistName peuvent être utilisés pour définir l’emplacement des données persistées.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>La politique de cache d’une donnée (opération ou attribut) est définie par une valeur par défaut présente dans le descripteur de la donnée. En général, l’adaptateur accède au Model MBean de l’application au travers de l’agent JMX mais une interrogation systématique n’est pas toujours nécessaire (ou voulue) : c’est pourquoi JMX offre la possibitilié de définir un cache d’accès à la ressource.<br />Pour ce faire, la description d’un attribut possède les clés prédéfinies <i>currencyTimeLimit</i> et <i>lastUpdatedTimeStamp</i>.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Le comportement par défaut offert par un Model MBean est généralement suffisant à la plupart des besoins. Cependant, JMX offre la possibilité de relier le Model MBean de l’application à un modèle de données différent. Cela peut se produire dans le cas, par exemple, où un MIB spécifique existe dans le système : le générateur de MIB peut alors intéragir directement avec l’agent JMX et créer un fichier MIB qui sera chargé par un système de supervision SNMP.<br />Pour cela, le descripteur d’un attribut ou d’une opération propose le champ <i>protocolMap</i> qui doit alors contenir une référence à une instance de la classe implémentant l’interface <i>Descriptor</i>.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Si l’implémentation d’un agent JMX supporte les opérations dans un environnement multi-agent JMX, alors il peut avoir besoin d’avertir de son existance et de sa disponibilité un service de recherche. Il peut également avoir besoin d’enregistrer en son sein des MBean qui peuvent être localisés sur d’autres agents JMX sans avoir à connaitre ces derniers.<br />Pour ce faire, le descripteur de son <i>ModelMBeanInfo</i> propose le champ prédéfini <i>export</i> dont la valeur peut être le nom ou l’objet requis pour exporter le MBean. S’il vaut F ou false, alors le MBean ne sera pas exporté.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Il peut parfois être nécessaire d’avoir différent niveau de lisibilité sur les différents MBeans du système.<br />Pour cela, il est possible d’utiliser le champ <i>visibility</i> du descripteur. Il peut prendre une  valeur entière de 1 à 4 et peut s’appliquer au niveau du MBean, d’un attribut ou d’une opération.<br />Dans ce cas, c’est à l‘implémentation de l’adaptateur de protocole, du connecteur ou de l’interface de gestion de filtrer les différentes informations à remonter.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Dans le cas où l’interface de gestion doit etre dynamique (ie. qu’elle doit générer son interface en fonction des MBeans découverts ou présents) il est  possible d’utiliser le champ <i>presentationString</i> du descripteur.<br />Il doit contenir une chaine de caractères au format XML.<br />Il est à noter, qu’actuellement, il n’existe pas de standardisation de la représentation de ce champ.</td></tr></tbody></table><table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;"><tbody><tr><td><span class="Apple-style-span"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></span></td><td>Une liste exhaustive des champs prédéfinis des descripteurs peut être trouvée dans la version agrégée de la spécification <a href="http://download.oracle.com/javase/6/docs/technotes/guides/jmx/JMX_1_4_specification.pdf">JMX au chapitre 4.5 Predefined Descriptor Fields</a>.</td></tr></tbody></table></div><h1>Le mot de la fin de cette partie</h1>Ainsi s'achève cette partie qui a permis de voir les notions de MBeans (en particulier les différences entre les différents MBeans) et de Notification.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Sarah Kocha</div>
<div class='content'>
Bonjour, <br />j&#39;ai bien aimé la suite de cours sur jmx <br />bonne continuation :)<br />à bientôt</div>
</div>
</div>
