
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JMX Pour Les Nuls... - Les Services JMX - Partie 7 - Jetoile</title>
  <meta name="author" content="Khanh Maudoux">

  <meta content='blog sur Java jee' name='description'/>
  <meta content='jee, java, cloud, nosql' name='keywords'/>
  <meta content='index, follow' name='robots'/>
  <link href='url' rel='canonical'/>

  
  <meta name="description" content="JMX Pour Les Nuls... - Les Services JMX - Partie 7 December 13, 2010 Ce septième et avant dernier article sur JMX (cf. introduction, partie 1 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.jetoile.fr/2010/12/jmx-pour-les-nuls-les-services-jmx.html">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jetoile" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>

  <script src="/javascripts/monthly_archive.js"></script>
  <!-- font-family: 'Knewave', cursive; -->
<link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>
<!-- font-family: 'Cantata One', serif; -->
<link href='http://fonts.googleapis.com/css?family=Cantata+One' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11955429-1']);
    _gaq.push(['_trackPageview']);
    _gaq.push(['_setDomainName','github.io']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>JMX Pour Les Nuls... - Les Services JMX - Partie 7</h1>
        <div class="meta">
          








  



<time datetime="2010-12-13T17:01:18+01:00" pubdate data-updated="true">December 13, 2010</time>  
        </div>
        <p><img src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TMdPuTpRY8I/AAAAAAAAALQ/R_w0PiLpvwo/s200/jmx-cover.png" alt="left" /></p>

<p>Ce septième et avant dernier article sur JMX (cf. <a href="/2010/10/jmx-pour-les-nuls-introduction.html">introduction</a>, <a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html">partie 1</a> portant sur les généralités, <a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html">partie 2</a> portant sur les différents MBeans et le concept de Notification, <a href="/2010/11/jmx-pour-les-nuls-les-agents-jmx-partie.html">partie 3</a> sur les agents JMX, <a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html">partie 4</a> sur les classes de base, <a href="/2010/11/jmx-pour-les-nuls-le-mbean-server.html">partie 5</a> sur le MBeanServer et <a href="/2010/12/jmx-pour-les-nuls-chargement-dynamique.html">partie 6</a> sur le chargement dynamique des MBeans) abordera les différents types de services JMX.</p>

<p>Le MBean Server propose, par défaut, un ensemble de fonctionnalités qui se présente sous forme de services JMX (ie. de MBeans), à savoir :</p>

<ul>
<li><strong>Service Monitoring</strong></li>
<li><strong>Service Timer</strong></li>
<li><strong>Service de relation</strong></li>
<li><strong>Service de sécurité</strong></li>
</ul>


<!-- more -->


<h1>Table des matières</h1>

<ul>
<li>JMX, qu&#8217;est ce que c&#8217;est?

<ul>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#generalite">Généralités</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#architecture">Architecture JMX</a>

<ul>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#instrumentation">Niveau instrumentation</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#agent">Niveau agent</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#distribue">Niveau service distribué</a></li>
</ul>
</li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#composant">Composants JMX</a>

<ul>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#mbean">MBeans</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#notification">Modèle de notifications</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#metadonnee">Classe de métadonnées de MBeans</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#serveur">Serveur de MBeans</a></li>
<li><a href="/2010/10/jmx-pour-les-nuls-les-concepts-partie-1.html#service">Service d&#8217;agents</a></li>
</ul>
</li>
</ul>
</li>
<li>Spécifications

<ul>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html">JMX Instrumentation</a>

<ul>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean">MBean</a>

<ul>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_standard">MBean Standard</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_dynamic">Dynamic MBean</a></li>
</ul>
</li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#notification">Notification</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_open">Open MBean</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-differents-mbeans.html#mbean_model">Model MBean</a></li>
</ul>
</li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-agents-jmx-partie.html#agent">Agent JMX</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html">Concepts</a>

<ul>
<li><a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectName">ObjectName</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#objectInstance">ObjectInstance</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#attribute">Attribute et AttributeList</a></li>
<li><a href="/2010/11/jmx-pour-les-nuls-les-classes-de-base.html#exception">Les Exceptions</a></li>
</ul>
</li>
<li><a href="/2010/11/jmx-pour-les-nuls-le-mbean-server.html#mbean_server">MBean Server</a></li>
<li><a href="/2010/12/jmx-pour-les-nuls-chargement-dynamique.html#mbean_dynamic">Chargement dynamique des MBeans</a></li>
<li><a href="/2010/12/jmx-pour-les-nuls-les-services-jmx.html">Les services JMX</a>

<ul>
<li><a href="/2010/12/jmx-pour-les-nuls-les-services-jmx.html#monitoring">Service Monitoring</a></li>
<li><a href="/2010/12/jmx-pour-les-nuls-les-services-jmx.html#timer">Service Timer</a></li>
<li><a href="/2010/12/jmx-pour-les-nuls-les-services-jmx.html#relation">Service Relation</a></li>
<li><a href="/2010/12/jmx-pour-les-nuls-les-services-jmx.html#securite">Service Sécurité</a></li>
</ul>
</li>
<li><a href="/2010/12/jmx-pour-les-nuls-les-connecteurs.html#connector">Les Connecteurs</a></li>
</ul>
</li>
</ul>


<p><a name="monitoring"></a></p>

<h1>Service Monitoring</h1>

<p>Il existe une famille de MBeans de monitoring qui se présentent qui permettent de scrupter les variations au cours du temps de la valeur des attributs des autres MBeans et qui permet d&#8217;émettre des notifications à intervalle régulier. Ils sont aussi classifiés comme des services de monitoring.</p>

<p>En fait, un service de monitoring (et donc un MBean de monitoring) permet d&#8217;observer la valeur d&#8217;un attribut donné présent dans un ou plusieurs MBeans (on dit qu&#8217;il s&#8217;agit alors du <strong>MBean observé</strong>) à un intervalle à régulier. Cette valeur peut être indifféremment la valeur d&#8217;un attribut ou la valeur contenue dans la valeur d&#8217;un attribut s&#8217;il est de type complexe. Pour chaque MBean observé, le moniteur interpole une seconde valeur qui est appelé le <em>pas dérivé</em> (<strong>derived gauge</strong>) et qui correspond, soit à la valeur observée, soit à la différence entre deux valeurs numériques obtenues consécutivement.</p>

<p>Un type de notification spécifique est alors émis à chaque service de monitoring lorsque le pas dérivé répond à un ou un ensemble de conditions (ou lorsque certaines erreurs se produisent) qui peuvent être initialisées lors de l&#8217;initialisation du moniteur ou dynamiquement au travers de l&#8217;interface d&#8217;administration du MBean moniteur.</p>

<p>Il existe trois types de moniteurs :</p>

<ul>
<li><strong>CounterMonitor</strong> qui permet de scrupter des valeurs de type entier (Byte, Integer, Short, Long) et qui se comporte comme un compteur :

<ul>
<li>les valeurs ne peuvent être inférieures strictement à 0,</li>
<li>les valeurs ne peuvent qu&#8217;être incrémentées,</li>
<li>les valeurs peuvent être tournantes (dans ce cas un modulo doit être défini).</li>
</ul>
</li>
<li><strong>GaugeMonitor</strong> qui permet de scrupter des valeurs de types entier ou flottantes (Float, Double) et qui se comporte comme un pas</li>
<li><strong>StringMonitor</strong> qui permet de scrupter des valeurs de type String.</li>
</ul>


<p>Tous ces moniteurs doivent étendre la classe abstraite <code>Monitor</code> alors que les types des valeurs surveillées doivent être supportés par le type de moniteur utilisé. Cependant, il est à noter que le moniteur vérifie le type de la valeur de l&#8217;instance retournée et non le te type de l&#8217;attribué déclaré dans les méta-données du MBean observé.</p>

<p><img src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKLxHRkZAI/AAAAAAAAAP4/eZfErdqRqWE/s1600/jmx58.png" alt="medium" /></p>

<p><img src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMExdR2sI/AAAAAAAAAP8/LvN1aDxsNIc/s1600/jmx59.png" alt="medium" /></p>

<p><img src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKMQ5MDK8I/AAAAAAAAAQA/sszqSpNWdeM/s1600/jmx60.png" alt="medium" /></p>

<p><img src="http://4.bp.blogspot.com/_XLL8sJPQ97g/TPKNgMBobwI/AAAAAAAAAQI/NyLwm_9d4oc/s1600/jmx76.png" alt="medium" /></p>

<p>Pour les notifications, une sous classe spécifique de <code>Notification</code> est définie pour être utilisée par tous les services de monitoring. Il s&#8217;agit de la classe <code>MonitorNotification</code>.</p>

<p>Ainsi, elle est utilisée pour rapporter les cas suivants :</p>

<ul>
<li>Une condition de déclenchement d&#8217;un moniteur est détectée (par exemple, si le seuil d&#8217;une valeur est atteinte)</li>
<li>Une erreur s&#8217;est produite durant la scrutation d&#8217;un attribut (par exemple, si un MBean est désenregistré)</li>
</ul>


<p><img src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKOjDQNWDI/AAAAAAAAAQM/qL7w59mPIcM/s1600/jmx77.png" alt="medium" /></p>

<p>La figure suivante représente tous les types de notifications qui peuvent être générées par un service Monitor.</p>

<p><img src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TPKO0P3FAEI/AAAAAAAAAQQ/FSwyMlB4ryI/s1600/jmx57.png" alt="medium" /></p>

<p><a name="timer"></a></p>

<h1>Service Timer</h1>

<p>Le service Timer permet de déclencher des notifications à des dates et heures spécifiques ou à intervalles réguliers. Les notifications sont émises à tous les objets déclarés comme étant interessés par les notifications émises par le timer (patron <strong>Observer</strong>).</p>

<p>Le service Timer est un MBean qui peut être managé en permettant, entre autre, aux applications de modifier la configuration de son ordonnanceur (<strong>scheduler</strong>).</p>

<p>En fait, la classe Timer gère une liste de notifications datées qui sont émises quand leur date et heure arrivent. Les méthodes de cette classe permettent d&#8217;ajouter et de supprimer des notifications de sa liste. En fait, les types de notifications sont fournis par l&#8217;utilisateur avec la date et optionnellement la fréquence et le nombre de répétitions.</p>

<p><img src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKPT0nrpwI/AAAAAAAAAQU/_P4QW-Dln5I/s1600/jmx64.png" alt="medium" /></p>

<p>Pour les notifications, une sous classe spécifique de <code>Notification</code> est définie pour être utilisée par le service <strong>Timer</strong>. Il s&#8217;agit de la classe <code>TimerNotification</code>.</p>

<p>Ainsi, elle est utilisée pour rapporter les cas suivants :</p>

<ul>
<li>Les notifications ne sont déclenchées qu&#8217;une seule fois</li>
<li>Les notifications sont répétées à une période définie et/ou un nombre d&#8217;occurrences</li>
</ul>


<p>Ces paramètres sont définis lorsque la notification est ajoutée à la liste de notifications du timer. En outre, à chacune des notifications émises est associée un identifiant unique.</p>

<p><img src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKPwGfdiTI/AAAAAAAAAQY/YNQBbw48Vsw/s1600/jmx61.png" alt="medium" /></p>

<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
Si la notification ajoutée au service Timer possède une date antérieure à la date courante, alors la méthode addNotification se comporte comme si la date indiquée était la date courante.
</ul></td></tr>
</tbody></table>


<br/>


<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
Si la date d&#8217;émission d&#8217;une notification est mise à jour alors qu&#8217;elle est déjà existante, alors aucune notification de mise à jour n&#8217;est émise.
</ul></td></tr>
</tbody></table>


<p>Le service Timer MBean est un émetteur standard de notifications (qui possèdent un type et une date définis dans la liste de notifications ajoutées à l&#8217;aide de la méthode <code>addNotification()</code>). Tous les écouteurs d&#8217;un MBean Timer donnés reçoivent toutes les notifications. Les écouteurs interessés par un type de notifications Timer particulier doivent spécifier un objet filtre lors de leur enregistrement.</p>

<p>Lorsqu&#8217;un timer est actif et que la date d&#8217;une notification de type Timer arrive à son terme, le service Timer émet cette notification en fournissant son type, message, données utilisateurs ainsi que l&#8217;identifiant de la notification. S&#8217;il s&#8217;agit d&#8217;une notification périodique disposant d&#8217;un nombre d&#8217;occurrence, il est décrémenté.</p>

<p>Enfin, si la notification n&#8217;a plus besoin d&#8217;être émise (notification non récurente ou notification périodique disposant d&#8217;un nombre d&#8217;émission prédéfini), elle est supprimée de la liste des notifications.</p>

<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
Si une notification dispose d&#8217;une date d&#8217;émission antérieure à son démarrage, il est possible de l&#8217;émettre ou de l&#8217;ignorer à l&#8217;aide de la méthode sendPastNotification(). Par défaut, la valeur de cet attribut est mise à false.
</ul></td></tr>
</tbody></table>


<p><a name="relation"></a></p>

<h1>Service Relation</h1>

<p>JMX définit un modèle de relation entre les MBeans. Une relation est définie par l&#8217;utilisateur et se présente comme une association n-aire entre les MBeans.</p>

<p>Pour ce faire, JMX propose un ensemble de classes à utiliser pour décrire les relations, ainsi qu&#8217;un service qui permet de centraliser toutes les opérations de mise en relation.</p>

<p>Toutes les relations permettent d&#8217;associer un type de relations (qui fournit des informations sur les rôles qu&#8217;il contient comme la multiplicité) avec le nom de classe du MBean qui satisfait le rôle.</p>

<p>Le service de relations permet également de chercher un MBean au travers de ses relations.</p>

<p>Il est garant de la consistance des relations en vérifiant les opérations et le désenregistrement des MBean afin de s&#8217;assurer que les relations sont toujours conformes. Si une relation n&#8217;est plus valide, elle est supprimée du service de relations même si ses MBeans membres restent présents.</p>

<p>Une relation est composée de rôles nommés qui disposent d&#8217;une liste de MBeans associés à ce rôle. Cette liste doit être consistante avec les informations de multiplicité ainsi qu&#8217;avec les classes des MBean qui représentent ce rôle.</p>

<p>Un ensemble de définition de rôles constitue un type de relation.</p>

<p>Un type de relation est un patron pour toutes les instances de relations qui associent les MBeans représentant ses rôles.</p>

<p>Par la suite, le terme de relation signifiera une instance spécique d&#8217;une relation associant des MBeans existants aux rôles dans un type de relations défini.</p>

<p>Le tableau ci-dessous décrit les concepts nécessaires à la compréhension du modèle de relations défini par JMX :</p>

<table>
<thead>
<tr>
<th>Concept </th>
<th> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Role information </td>
<td> Décrit un des rôles dans une relation. L&#8217;information sur un rôle est composée du nom du rôle, de sa multiplicité, du nom de la classe qui participe à ce rôle, d&#8217;une propriété en lecture-seule sur les permissions et d&#8217;une description.</td>
</tr>
<tr>
<td>Relation type </td>
<td> Méta-donnée d&#8217;une relation, composée d&#8217;un ensemble de Role information. Permet de décrire les rôles qu&#8217;une relation satisfait et permet de servir de patron pour créer et maintenir des relations.</td>
</tr>
<tr>
<td>Relation </td>
<td>  Association courante entre des MBeans qui satisfont une relation donnéee. Une relation peut avoir des propriétés et méthodes qui ne s&#8217;appliquent qu&#8217;à ses MBeans.</td>
</tr>
<tr>
<td>Role Value </td>
<td>    Liste de MBeans qui satisfont un rôle donné dans une relation.</td>
</tr>
</tbody>
</table>


<p>Unresolved Role Résultat d&#8217;un accès illégal d&#8217;une opération sur un rôle. Contient la raison du refus de l&#8217;opération.
Support Classes | Classes internes utilisées pour représenter des types de relations et des instances de relations.
Relation Service |  MBean qui peut accéder et maintenir la consistance de tous les types de relations et toutes les instances de relations dans un agent JMX. Fournit des opérations pour trouver un MBean et ses rôles dans une relation.</p>

<p>En JMX, le type de relation est un ensemble statique de rôles. Les types de relations peuvent être définis à l&#8217;exécution mais, une fois défini, ces rôles et informations sur les rôles ne peuvent être modifiés.</p>

<p><u>Exemple de relations :</u>
Dans cet exemple, des livres (<em>Books</em>) et les propriétaires (<em>Owner</em>) représente des rôles :</p>

<ul>
<li>Books représente le nombre de livres que possède la classe d&#8217;un MBean donnée.</li>
<li>Owner représente un propriétaire de livres d&#8217;une autre classe d&#8217;un MBean.</li>
</ul>


<p>Un type de relations (<em>Personal Library</em>) peut être défini comme étant la notion d&#8217;appartenance de livres.</p>

<p><img src="http://2.bp.blogspot.com/_XLL8sJPQ97g/TPKRennmH-I/AAAAAAAAAQg/l79ynOUIw8k/s1600/jmx65.png" alt="medium" /></p>

<p>En fait, le service de relations empêche la création de types de relations invalides, de relations invalides ou la modifiation de valeurs de rôles invalides.</p>

<p>Quand une relation est supprimée du service de relations, ses MBeans membres ne sont pas impactés.
Quand un type de relation est supprimé, toutes les relations référencées sont au préalable supprimées. Cependant, c&#8217;est à l&#8217;appelant de gérer la consistance lors de la suppression d&#8217;un type de relations.</p>

<p>En outre, puisque les relations ne sont définies qu&#8217;au niveau des MBeans enregistrés, en supprimer un de l&#8217;annuaire est susceptible de modifier la relation. Le service de relations écoute, pour tous les MBean, le server de notifications qui indique quand un membre d&#8217;une relation est désenregistré. Le MBean correspondant est alors supprimé de tous rôles où il se trouve. Dans le cas où la nouvelle cardinalité du rôle n&#8217;est pas consistante avec son type de relation, alors la relation est supprimée du service de relation.</p>

<p>Le service de relations émet des notifications après l&#8217;exécution d&#8217;opérations qui modifient une instance de relations (création, mise à jour ou suppression). Cette notification fournit des informations sur la modification comme l&#8217;identifiant de la relation et la nouvelle valeur d&#8217;un rôle.</p>

<p>De plus, il est à noter qu&#8217;il existe deux types de relations et relations :</p>

<ul>
<li>Les types de relations et relations internes : les types de relations et leurs instances sont créés par le service de relations et ne sont accessibles qu&#8217;aux travers ses opéraitons.</li>
<li>Les types de relations et relations externes : les types de relations et leurs instances sont instanciés en dehors du service de relations puis lui sont ajoutés. Dans ce cas, ils peuvent être accessibles directement et, en l&#8217;occurrence, peuvent être enregistré comme des MBeans. Il est cependant à noter que ces types de relation sont immuables et qu&#8217;elles ne doivent pas être modifiées une fois enregistré dans le service de relation.</li>
</ul>


<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
En raison de la complexité de ce service, pour plus d&#8217;informations, il est préférable de se référer aux chapitres 11.2 Relation Service Classes, 11.3 Interfaces and Support Classes et 11.4 Role Description Classes des spécifications agrégées JMX.
</ul></td></tr>
</tbody></table>


<p><a name="securite"></a></p>

<h1>Service securité</h1>

<p>Un MBean Server JMX peut avoir accès à des informations sensibles et peut être susceptible d&#8217;exposer des opérations sensibles. Pour ce faire, JMX propose un mécanisme d&#8217;accès à de telles opérations en s&#8217;appuyant sur le modèle de sécurité de Java : il est possible de définir des permissions qui permettent de contrôler l&#8217;accès au MBean Server et à ses opérations.</p>

<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
La sécurisation du MBean Server s&#8217;appuyant sur le modèle standard de sécurité Java, il est nécessaire de disposer du gestionnaire de sécurité Java (security manager). La méthode statique System.getSecurityManager() permet de le vérifier.
</ul></td></tr>
</tbody></table>




<br/>




<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
Pour rappel, le modèle de sécurité de Java s&#8217;appuie sur le principe de permissions : pour qu&#8217;une opération soit invocable, l&#8217;appelant doit posséder la/les permissions.<br />
En effet, à un point donné de l&#8217;exécution d&#8217;un programme correspond un ensemble de permissions appliqué à l&#8217;exécution d&#8217;un thread. <br />
En fait, une opération est autorisée si le thread qui l&#8217;invoque dispose des permissions nécessaires.<br />
<br />
Les permissions sont des objets java qui étendent la classe <i>Permission</i>.<br />
<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKS5FhDvOI/AAAAAAAAAQk/QbB4KTZsUXA/s1600/jmx66.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="263" src="http://1.bp.blogspot.com/_XLL8sJPQ97g/TPKS5FhDvOI/AAAAAAAAAQk/QbB4KTZsUXA/s320/jmx66.png" width="320" /></a></div>
</ul></td></tr>
</tbody></table>


<p>En fait, JMX défini, par défaut, sa propre permission MBeanServerPermission qui peut être configurée comme suit :</p>

<ul>
<li><code>MBeanServerPermission</code> qui prend en paramètre de son constructeur une chaine de caractère représentant la liste des opérations autorisées sur le MBeanServer (ex : <code>MBeanServerPermission("createMBeanServer")</code> qui permet de controler l&#8217;accès aux méthodes <code>MBeanServerFactory.createMBeanServer</code> )</li>
<li><code>MBeanPermission</code> qui prend en paramètre deux chaines de caractères :

<ul>
<li>la première représente la cible et peut être composée du nom canonique de la classe ou d&#8217;une expression régulière, du membre (c&#8217;est-à-dire le nom de l&#8217;attribut ou de l&#8217;opération qui doit être accédé), et de l&#8217;ObjetName du MBean cible.</li>
</ul>
</li>
</ul>


<p><u>Exemples de cible :</u></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>com.example.Resource#Name[com.example.main:type=resource]
</span><span class='line'>com.example.Resource#*[com.example.main:type=resource]
</span><span class='line'>*#Name[com.example.main:type=resource]
</span></code></pre></td></tr></table></div></figure>


<ul><li><ul>
<li>la  deuxième représente l&#8217;action une ou plusieurs méthodes du MBean Server parmi les suivantes :</li>
<li><ul>
    <li>`addNotificationListener`</li>
    <li>`getAttribute`</li>
    <li>`getClassLoader`</li>
    <li>`getClassLoaderFor`</li>
    <li>`getClassLoaderRepository`</li>
    <li>`getMBeanInfo`</li>
    <li>`getObjectInstance`</li>
    <li>`instantiate`</li>
    <li>`invoke`</li>
    <li>`isInstanceOf`</li>
    <li>`queryMBeans`</li>
    <li>`queryNames`</li>
    <li>`registerMBean`</li>
    <li>`removeNotificationListener`</li>
    <li>`setAttribute`</li>
    <li>`unregisterMBean`</li>
</ul>
</li>
</ul></li></ul>




<table border="1" cellpadding="0" cellspacing="0" style="text-align: justify;" width="100%"><tbody>
<tr><td style="border: 0px; text-align: center;"><a href="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_XLL8sJPQ97g/TNCS7qzv19I/AAAAAAAAAL4/6qkEYy4pX6o/s1600/remarque.png" style="cursor: move;" /></a></td> <td style="border: 0px;">
Les opérations suivantes ne sont pas soumises à la sécurisation du MBean Server :<br />
<ul><li><i>isRegistered</i></li>
<li><i>getMBeanCount</i></li>
<li><i>getDefaultDomain</i></li>
</ul>
</ul></td></tr>
</tbody></table>


<p>De plus, JMX propose la permission <code>MBeanTrustPermission</code> qui permet de faire confiance à un certain utilisateur ou code source signé. Si le signataire ou le code source possède cette permission, le MBean est considéré comme étant de confiance. Seuls les MBeans de confiance peuvent alors être enregistrés dans le MBean Server.</p>

<p>Une permission <code>MBeanTrustPermission</code> est configurée soit avec la valeur &ldquo;register&rdquo;, soit avec la valeur  &ldquo;*&rdquo; qui signifient toutes deux la même chose dans la version courante de la version JMX.</p>

<p>Ainsi, utilisé en complément de la permission <code>MBeanPermission</code>, la permission <code>MBeanTrustPermission</code> permet une gestion de la sécurité plus fine sur l&#8217;enregistrement des MBeans : la permission <code>MBeanPermission</code> vérifie qui enregistre alors que la permission <code>MBeanTrustPermission</code> vérifie ce qui est enregistré.</p>

<p><u>Exemples de fichier de policy :</u></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>grant {
</span><span class='line'>    permission javax.management.MBeanPermission &quot;*&quot;, &quot;*&quot;;
</span><span class='line'>};
</span><span class='line'>
</span><span class='line'>grant codeBase &quot;file:${user.dir}${/}appl1.jar&quot; {
</span><span class='line'>    permission javax.management.MBeanPermission &quot;&quot;, &quot;getClassLoaderRepository&quot;;
</span><span class='line'>};
</span><span class='line'>
</span><span class='line'>grant codeBase &quot;file:${user.dir}${/}appl2.jar&quot; {
</span><span class='line'>    permission javax.management.MBeanPermission &quot;[d1:*]&quot;, &quot;isInstanceOf, getObjectInstance&quot;;
</span><span class='line'>};
</span><span class='line'>
</span><span class='line'>grant codeBase &quot;file:${user.dir}${/}appl3.jar&quot; {
</span><span class='line'>    permission javax.management.MBeanServerPermission &quot;findMBeanServer&quot;;
</span><span class='line'>    permission javax.management.MBeanPermission &quot;JMImplementation:*&quot;, &quot;queryNames&quot;;
</span><span class='line'>};
</span><span class='line'>
</span><span class='line'>grant {
</span><span class='line'>    permission javax.management.MBeanTrustPermission &quot;register&quot;;
</span><span class='line'>};
</span><span class='line'>
</span><span class='line'>grant signedBy &quot;Gorey&quot; {
</span><span class='line'>    permission javax.management.MBeanTrustPermission &quot;register&quot;;
</span><span class='line'>};
</span></code></pre></td></tr></table></div></figure>



<footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Khanh Maudoux</span></span>

      </p>
      <p class="meta">
      








  



<time datetime="2010-12-13T17:01:18+01:00" pubdate data-updated="true">December 13, 2010</time> in 

<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>java</a>, <a class='category' href='/blog/categories/jmx/'>jmx</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.jetoile.fr/2010/12/jmx-pour-les-nuls-les-services-jmx.html" data-via="jetoile" data-counturl="http://blog.jetoile.fr/2010/12/jmx-pour-les-nuls-les-services-jmx.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
</footer>

<!--
<section>
<h1>Comments</h1>
<script>
var idcomments_acct = '1a2a89d3b135fb1f774e938fd286d920';
var idcomments_post_id;
var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>

</section>
-->


  <section>
    <h1>Comments</h1>

    <!--
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jetoile'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
-->

<div id="disqus_thread"></div>
  

<script type="text/javascript">
      var disqus_shortname = 'jetoile';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.jetoile.fr/2010/12/jmx-pour-les-nuls-les-services-jmx.html';
        var disqus_url = 'http://blog.jetoile.fr/2010/12/jmx-pour-les-nuls-les-services-jmx.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

  </section>


      </div>
    </div>
  </div>



</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <a class="pull-center" href="/" title="Home">Home</a>
    </div>
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/2010/12/jmx-pour-les-nuls-chargement-dynamique.html" title="Previous Post: JMX pour les nuls... - Chargement dynamique de MBeans - Partie 6">&laquo; Previous: JMX pour les nuls... - Chargement dynamique de MBeans - Partie 6</a>
        

        
          <a class="pull-right" href="/2010/12/jmx-pour-les-nuls-les-connecteurs.html" title="Next Post: JMX pour les nuls... - Les connecteurs - Partie 8">Next: JMX pour les nuls... - Les connecteurs - Partie 8 &raquo;</a>
        
      </div>
    </div>
  </div>
</div>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<script type="text/javascript">
  window.___gcfg = {lang: 'fr'};

  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div id='footer-shadow'></div>
<!--//please give me a respect for keep these credits line -->
<div class='credits'>
<div align='center'>

<table style="border:none;border-spacing: 20px;border-collapse: separate;">
<tr style="border:none">
<td style="border:none">
<a href="http://twitter.com/jetoile" class="twitter-follow-button" data-show-count="false" data-lang="fr">Follow @jetoile</a>
<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
</td>
<td style="border:none">
<a href="https://plus.google.com/u/0/114765959876500830478/posts?prsrc=3" style="text-decoration: none; color: #333;"><div style="display: inline-block;"><span style="float: left; font: bold 13px/16px arial,sans-serif; margin-right: 4px; margin-top: 7px;">khanh</span><span style="float: left; font: 13px/16px arial,sans-serif; margin-right: 11px; margin-top: 7px;">on</span><div style="float: left;"><img src="/images/gplus-32.png" width="32" height="32" style="border: 0;"/></div><div style="clear: both"></div></div></a>
</td>
<td style="border:none">
<a href="http://fr.linkedin.com/pub/khanh-tuong-maudoux/19/92b/11b"><img src="/images/btn_profile_bluetxt_8
0x15_fr_FR.png" width="80" height="15" border="0" alt="Voir le profil de Khanh Tuong Maudoux sur LinkedIn" /></a>
</td>
</tr>
</table>


<img alt='Jetoile' height='50' src='/images/logoJetoile_v51.png' style='border-width:0; vertical-align: middle' width='180'/>
<p>&#169; 2011 <a href='http://blog.jetoile.fr/'>Je toile ou j* au choix...</a> - Khanh Maudoux</p>
<a href='http://creativecommons.org/licenses/by/4.0/' rel='license'><img alt='Licence Creative Commons' src='/images/creative_common88x31.png' style='border-width:0'/></a> Cette œuvre de <a href='http://blog.jetoile.fr' property='cc:attributionName' rel='cc:attributionURL' xmlns:cc='http://creativecommons.org/ns#'>http://blog.jetoile.fr</a> est mise à disposition selon les termes de la <a href='http://creativecommons.org/licenses/by/4.0/' rel='license'>licence Creative Commons Attribution 4.0 International</a>.
<!--img alt='Creative Commons License' src='http://i.creativecommons.org/l/by/2.0/fr/88x31.png' style='border-width:0; vertical-align: middle;'/> <small>Sauf mention contraire, le contenu de ce blog est mis à disposition selon les termes de la licence <a href='http://creativecommons.org/licenses/by/2.0/fr/'>Creative Commons Attribution 2.0 License</a>.</small-->
<br/>
<small>Powered by <a href="http://octopress.org">Octopress</a><br/>
</small>
</div>
</div>


    </div>
  </div>
</footer>

  </body>
</html>
